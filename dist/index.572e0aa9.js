var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},r=e.parcelRequirec189;function i(e){return e=e||[],Array.isArray(e)?e:[e]}function o(e){return`[Vaadin.Router] ${e}`}null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in n){var r=n[e];delete n[e];var i={id:e,exports:{}};return t[e]=i,r.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequirec189=r),r.register("8vghX",(function(e,t){var n=r("hPtJY"),i=r("kjyEk"),o=r("k3kFo"),s=r("broFN");const a=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function c(e){console.log(`[dotenv][DEBUG] ${e}`)}const l={config:function(e){let t=o.resolve(n.cwd(),".env"),r="utf8";const a=Boolean(e&&e.debug),u=Boolean(e&&e.override);var h;e&&(null!=e.path&&(t="~"===(h=e.path)[0]?o.join(s.homedir(),h.slice(1)):h),null!=e.encoding&&(r=e.encoding));try{const e=l.parse(i.readFileSync(t,{encoding:r}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(n.env,t)?(!0===u&&e[t],a&&c(!0===u?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):e[t]})),{parsed:e}}catch(e){return a&&c(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let n,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(n=a.exec(r));){const e=n[1];let r=n[2]||"";r=r.trim();const i=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===i&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t}};e.exports.config=l.config,e.exports.parse=l.parse,e.exports=l})),r.register("hPtJY",(function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}})),r.register("kjyEk",(function(e,t){})),r.register("k3kFo",(function(e,t){var n=r("bwtrh");function i(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function o(e,t){for(var n,r="",i=0,o=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){-1===c?(r="",i=0):i=(r=r.slice(0,c)).length-1-r.lastIndexOf("/"),o=a,s=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=a,s=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,a):r=e.slice(o+1,a),i=a-o-1;o=a,s=0}else 46===n&&-1!==s?++s:s=-1}return r}var s={resolve:function(){for(var e,t="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var a;s>=0?a=arguments[s]:(void 0===e&&(e=n.cwd()),a=e),i(a),0!==a.length&&(t=a+"/"+t,r=47===a.charCodeAt(0))}return t=o(t,!r),r?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(i(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=o(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return i(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];i(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":s.normalize(e)},relative:function(e,t){if(i(e),i(t),e===t)return"";if((e=s.resolve(e))===(t=s.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var r=e.length,o=r-n,a=1;a<t.length&&47===t.charCodeAt(a);++a);for(var c=t.length-a,l=o<c?o:c,u=-1,h=0;h<=l;++h){if(h===l){if(c>l){if(47===t.charCodeAt(a+h))return t.slice(a+h+1);if(0===h)return t.slice(a+h)}else o>l&&(47===e.charCodeAt(n+h)?u=h:0===h&&(u=0));break}var d=e.charCodeAt(n+h);if(d!==t.charCodeAt(a+h))break;47===d&&(u=h)}var f="";for(h=n+u+1;h<=r;++h)h!==r&&47!==e.charCodeAt(h)||(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(a+u):(a+=u,47===t.charCodeAt(a)&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(i(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,o=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!o){r=s;break}}else o=!1;return-1===r?n?"/":".":n&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');i(e);var n,r=0,o=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,c=-1;for(n=e.length-1;n>=0;--n){var l=e.charCodeAt(n);if(47===l){if(!s){r=n+1;break}}else-1===c&&(s=!1,c=n+1),a>=0&&(l===t.charCodeAt(a)?-1==--a&&(o=n):(a=-1,o=c))}return r===o?o=c:-1===o&&(o=e.length),e.slice(r,o)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!s){r=n+1;break}}else-1===o&&(s=!1,o=n+1);return-1===o?"":e.slice(r,o)},extname:function(e){i(e);for(var t=-1,n=0,r=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===r&&(o=!1,r=a+1),46===c?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!o){n=a+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===n+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+e+r:r}("/",e)},parse:function(e){i(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,r=e.charCodeAt(0),o=47===r;o?(t.root="/",n=1):n=0;for(var s=-1,a=0,c=-1,l=!0,u=e.length-1,h=0;u>=n;--u)if(47!==(r=e.charCodeAt(u)))-1===c&&(l=!1,c=u+1),46===r?-1===s?s=u:1!==h&&(h=1):-1!==s&&(h=-1);else if(!l){a=u+1;break}return-1===s||-1===c||0===h||1===h&&s===c-1&&s===a+1?-1!==c&&(t.base=t.name=0===a&&o?e.slice(1,c):e.slice(a,c)):(0===a&&o?(t.name=e.slice(1,s),t.base=e.slice(1,c)):(t.name=e.slice(a,s),t.base=e.slice(a,c)),t.ext=e.slice(s,c)),a>0?t.dir=e.slice(0,a-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};s.posix=s,e.exports=s})),r.register("bwtrh",(function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}})),r.register("broFN",(function(e,t){var n,r,i,o,s;n=e.exports,r="homedir",i=()=>s,o=e=>s=e,Object.defineProperty(n,r,{get:i,set:o,enumerable:!0,configurable:!0}),s=function(){return"/"}})),r.register("f1q41",(function(t,n){(function(){var r,i="Expected a function",o="__lodash_hash_undefined__",s="__lodash_placeholder__",a=16,c=32,l=64,u=128,h=256,d=1/0,f=9007199254740991,p=NaN,_=4294967295,g=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",a],["flip",512],["partial",c],["partialRight",l],["rearg",h]],m="[object Arguments]",v="[object Array]",y="[object Boolean]",b="[object Date]",w="[object Error]",C="[object Function]",E="[object GeneratorFunction]",I="[object Map]",T="[object Number]",x="[object Object]",k="[object Promise]",S="[object RegExp]",N="[object Set]",R="[object String]",P="[object Symbol]",A="[object WeakMap]",O="[object ArrayBuffer]",D="[object DataView]",L="[object Float32Array]",M="[object Float64Array]",F="[object Int8Array]",j="[object Int16Array]",q="[object Int32Array]",U="[object Uint8Array]",B="[object Uint8ClampedArray]",W="[object Uint16Array]",$="[object Uint32Array]",z=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,V=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Y=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>"']/g,G=RegExp(Y.source),Q=RegExp(K.source),J=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,te=/^\w*$/,ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,re=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(re.source),oe=/^\s+/,se=/\s/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ce=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,he=/[()=,{}\[\]\/\s]/,de=/\\(\\)?/g,fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,_e=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,ye=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,Ce=/['\n\r\u2028\u2029\\]/g,Ee="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ie="\\u2700-\\u27bf",Te="a-z\\xdf-\\xf6\\xf8-\\xff",xe="A-Z\\xc0-\\xd6\\xd8-\\xde",ke="\\ufe0e\\ufe0f",Se="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ne="['’]",Re="[\ud800-\udfff]",Pe="["+Se+"]",Ae="["+Ee+"]",Oe="\\d+",De="[\\u2700-\\u27bf]",Le="["+Te+"]",Me="[^\ud800-\udfff"+Se+Oe+Ie+Te+xe+"]",Fe="[^\ud800-\udfff]",je="(?:\ud83c[\udde6-\uddff]){2}",qe="[\ud800-\udbff][\udc00-\udfff]",Ue="["+xe+"]",Be="(?:"+Le+"|"+Me+")",We="(?:"+Ue+"|"+Me+")",$e="(?:['’](?:d|ll|m|re|s|t|ve))?",ze="(?:['’](?:D|LL|M|RE|S|T|VE))?",He="(?:"+Ae+"|"+"\ud83c[\udffb-\udfff])"+"?",Ve="[\\ufe0e\\ufe0f]?",Ye=Ve+He+("(?:\\u200d(?:"+[Fe,je,qe].join("|")+")"+Ve+He+")*"),Ke="(?:"+[De,je,qe].join("|")+")"+Ye,Ge="(?:"+[Fe+Ae+"?",Ae,je,qe,Re].join("|")+")",Qe=RegExp(Ne,"g"),Je=RegExp(Ae,"g"),Xe=RegExp("\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|"+Ge+Ye,"g"),Ze=RegExp([Ue+"?"+Le+"+"+$e+"(?="+[Pe,Ue,"$"].join("|")+")",We+"+"+ze+"(?="+[Pe,Ue+Be,"$"].join("|")+")",Ue+"?"+Be+"+"+$e,Ue+"+"+ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oe,Ke].join("|"),"g"),et=RegExp("[\\u200d\ud800-\udfff"+Ee+ke+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,it={};it[L]=it[M]=it[F]=it[j]=it[q]=it[U]=it[B]=it[W]=it[$]=!0,it[m]=it[v]=it[O]=it[y]=it[D]=it[b]=it[w]=it[C]=it[I]=it[T]=it[x]=it[S]=it[N]=it[R]=it[A]=!1;var ot={};ot[m]=ot[v]=ot[O]=ot[D]=ot[y]=ot[b]=ot[L]=ot[M]=ot[F]=ot[j]=ot[q]=ot[I]=ot[T]=ot[x]=ot[S]=ot[N]=ot[R]=ot[P]=ot[U]=ot[B]=ot[W]=ot[$]=!0,ot[w]=ot[C]=ot[A]=!1;var st={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,ct=parseInt,lt="object"==typeof e&&e&&e.Object===Object&&e,ut="object"==typeof self&&self&&self.Object===Object&&self,ht=lt||ut||Function("return this")(),dt=n&&!n.nodeType&&n,ft=dt&&t&&!t.nodeType&&t,pt=ft&&ft.exports===dt,_t=pt&&lt.process,gt=function(){try{var e=ft&&ft.require&&ft.require("util").types;return e||_t&&_t.binding&&_t.binding("util")}catch(e){}}(),mt=gt&&gt.isArrayBuffer,vt=gt&&gt.isDate,yt=gt&&gt.isMap,bt=gt&&gt.isRegExp,wt=gt&&gt.isSet,Ct=gt&&gt.isTypedArray;function Et(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function It(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function xt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function St(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function Nt(e,t){return!!(null==e?0:e.length)&&qt(e,t,0)>-1}function Rt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Pt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function At(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Ot(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Dt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Lt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Mt=$t("length");function Ft(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function jt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function qt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):jt(e,Bt,n)}function Ut(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Bt(e){return e!=e}function Wt(e,t){var n=null==e?0:e.length;return n?Vt(e,t)/n:p}function $t(e){return function(t){return null==t?r:t[e]}}function zt(e){return function(t){return null==e?r:e[t]}}function Ht(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Vt(e,t){for(var n,i=-1,o=e.length;++i<o;){var s=t(e[i]);s!==r&&(n=n===r?s:n+s)}return n}function Yt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Kt(e){return e?e.slice(0,dn(e)+1).replace(oe,""):e}function Gt(e){return function(t){return e(t)}}function Qt(e,t){return Pt(t,(function(t){return e[t]}))}function Jt(e,t){return e.has(t)}function Xt(e,t){for(var n=-1,r=e.length;++n<r&&qt(t,e[n],0)>-1;);return n}function Zt(e,t){for(var n=e.length;n--&&qt(t,e[n],0)>-1;);return n}function en(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var tn=zt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),nn=zt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rn(e){return"\\"+st[e]}function on(e){return et.test(e)}function sn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function an(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function ln(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function un(e){return on(e)?function(e){var t=Xe.lastIndex=0;for(;Xe.test(e);)++t;return t}(e):Mt(e)}function hn(e){return on(e)?function(e){return e.match(Xe)||[]}(e):function(e){return e.split("")}(e)}function dn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var fn=zt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var pn=function e(t){var n,se=(t=null==t?ht:pn.defaults(ht.Object(),t,pn.pick(ht,nt))).Array,Ee=t.Date,Ie=t.Error,Te=t.Function,xe=t.Math,ke=t.Object,Se=t.RegExp,Ne=t.String,Re=t.TypeError,Pe=se.prototype,Ae=Te.prototype,Oe=ke.prototype,De=t["__core-js_shared__"],Le=Ae.toString,Me=Oe.hasOwnProperty,Fe=0,je=(n=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",qe=Oe.toString,Ue=Le.call(ke),Be=ht._,We=Se("^"+Le.call(Me).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$e=pt?t.Buffer:r,ze=t.Symbol,He=t.Uint8Array,Ve=$e?$e.allocUnsafe:r,Ye=an(ke.getPrototypeOf,ke),Ke=ke.create,Ge=Oe.propertyIsEnumerable,Xe=Pe.splice,et=ze?ze.isConcatSpreadable:r,st=ze?ze.iterator:r,lt=ze?ze.toStringTag:r,ut=function(){try{var e=fo(ke,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=t.clearTimeout!==ht.clearTimeout&&t.clearTimeout,ft=Ee&&Ee.now!==ht.Date.now&&Ee.now,_t=t.setTimeout!==ht.setTimeout&&t.setTimeout,gt=xe.ceil,Mt=xe.floor,zt=ke.getOwnPropertySymbols,_n=$e?$e.isBuffer:r,gn=t.isFinite,mn=Pe.join,vn=an(ke.keys,ke),yn=xe.max,bn=xe.min,wn=Ee.now,Cn=t.parseInt,En=xe.random,In=Pe.reverse,Tn=fo(t,"DataView"),xn=fo(t,"Map"),kn=fo(t,"Promise"),Sn=fo(t,"Set"),Nn=fo(t,"WeakMap"),Rn=fo(ke,"create"),Pn=Nn&&new Nn,An={},On=Uo(Tn),Dn=Uo(xn),Ln=Uo(kn),Mn=Uo(Sn),Fn=Uo(Nn),jn=ze?ze.prototype:r,qn=jn?jn.valueOf:r,Un=jn?jn.toString:r;function Bn(e){if(ra(e)&&!Vs(e)&&!(e instanceof Hn)){if(e instanceof zn)return e;if(Me.call(e,"__wrapped__"))return Bo(e)}return new zn(e)}var Wn=function(){function e(){}return function(t){if(!na(t))return{};if(Ke)return Ke(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function $n(){}function zn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}function Hn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_,this.__views__=[]}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Kn;++t<n;)this.add(e[t])}function Qn(e){var t=this.__data__=new Yn(e);this.size=t.size}function Jn(e,t){var n=Vs(e),r=!n&&Hs(e),i=!n&&!r&&Qs(e),o=!n&&!r&&!i&&ha(e),s=n||r||i||o,a=s?Yt(e.length,Ne):[],c=a.length;for(var l in e)!t&&!Me.call(e,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||bo(l,c))||a.push(l);return a}function Xn(e){var t=e.length;return t?e[Gr(0,t-1)]:r}function Zn(e,t){return Fo(Ri(e),cr(t,0,e.length))}function er(e){return Fo(Ri(e))}function tr(e,t,n){(n!==r&&!Ws(e[t],n)||n===r&&!(t in e))&&sr(e,t,n)}function nr(e,t,n){var i=e[t];Me.call(e,t)&&Ws(i,n)&&(n!==r||t in e)||sr(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(Ws(e[n][0],t))return n;return-1}function ir(e,t,n,r){return fr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function or(e,t){return e&&Pi(t,Oa(t),e)}function sr(e,t,n){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var n=-1,i=t.length,o=se(i),s=null==e;++n<i;)o[n]=s?r:Sa(e,t[n]);return o}function cr(e,t,n){return e==e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function lr(e,t,n,i,o,s){var a,c=1&t,l=2&t,u=4&t;if(n&&(a=o?n(e,i,o,s):n(e)),a!==r)return a;if(!na(e))return e;var h=Vs(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Me.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Ri(e,a)}else{var d=go(e),f=d==C||d==E;if(Qs(e))return Ii(e,c);if(d==x||d==m||f&&!o){if(a=l||f?{}:vo(e),!c)return l?function(e,t){return Pi(e,_o(e),t)}(e,function(e,t){return e&&Pi(t,Da(t),e)}(a,e)):function(e,t){return Pi(e,po(e),t)}(e,or(a,e))}else{if(!ot[d])return o?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case O:return Ti(e);case y:case b:return new r(+e);case D:return function(e,t){var n=t?Ti(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case L:case M:case F:case j:case q:case U:case B:case W:case $:return xi(e,n);case I:return new r;case T:case R:return new r(e);case S:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case N:return new r;case P:return i=e,qn?ke(qn.call(i)):{}}var i}(e,d,c)}}s||(s=new Qn);var p=s.get(e);if(p)return p;s.set(e,a),ca(e)?e.forEach((function(r){a.add(lr(r,t,n,r,e,s))})):ia(e)&&e.forEach((function(r,i){a.set(i,lr(r,t,n,i,e,s))}));var _=h?r:(u?l?oo:io:l?Da:Oa)(e);return Tt(_||e,(function(r,i){_&&(r=e[i=r]),nr(a,i,lr(r,t,n,i,e,s))})),a}function ur(e,t,n){var i=n.length;if(null==e)return!i;for(e=ke(e);i--;){var o=n[i],s=t[o],a=e[o];if(a===r&&!(o in e)||!s(a))return!1}return!0}function hr(e,t,n){if("function"!=typeof e)throw new Re(i);return Oo((function(){e.apply(r,n)}),t)}function dr(e,t,n,r){var i=-1,o=Nt,s=!0,a=e.length,c=[],l=t.length;if(!a)return c;n&&(t=Pt(t,Gt(n))),r?(o=Rt,s=!1):t.length>=200&&(o=Jt,s=!1,t=new Gn(t));e:for(;++i<a;){var u=e[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h==h){for(var d=l;d--;)if(t[d]===h)continue e;c.push(u)}else o(t,h,r)||c.push(u)}return c}Bn.templateSettings={escape:J,evaluate:X,interpolate:Z,variable:"",imports:{_:Bn}},Bn.prototype=$n.prototype,Bn.prototype.constructor=Bn,zn.prototype=Wn($n.prototype),zn.prototype.constructor=zn,Hn.prototype=Wn($n.prototype),Hn.prototype.constructor=Hn,Vn.prototype.clear=function(){this.__data__=Rn?Rn(null):{},this.size=0},Vn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vn.prototype.get=function(e){var t=this.__data__;if(Rn){var n=t[e];return n===o?r:n}return Me.call(t,e)?t[e]:r},Vn.prototype.has=function(e){var t=this.__data__;return Rn?t[e]!==r:Me.call(t,e)},Vn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rn&&t===r?o:t,this},Yn.prototype.clear=function(){this.__data__=[],this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,!0)},Yn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?r:t[n][1]},Yn.prototype.has=function(e){return rr(this.__data__,e)>-1},Yn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Kn.prototype.clear=function(){this.size=0,this.__data__={hash:new Vn,map:new(xn||Yn),string:new Vn}},Kn.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},Kn.prototype.get=function(e){return uo(this,e).get(e)},Kn.prototype.has=function(e){return uo(this,e).has(e)},Kn.prototype.set=function(e,t){var n=uo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Gn.prototype.add=Gn.prototype.push=function(e){return this.__data__.set(e,o),this},Gn.prototype.has=function(e){return this.__data__.has(e)},Qn.prototype.clear=function(){this.__data__=new Yn,this.size=0},Qn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Qn.prototype.get=function(e){return this.__data__.get(e)},Qn.prototype.has=function(e){return this.__data__.has(e)},Qn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Yn){var r=n.__data__;if(!xn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Kn(r)}return n.set(e,t),this.size=n.size,this};var fr=Di(wr),pr=Di(Cr,!0);function _r(e,t){var n=!0;return fr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function gr(e,t,n){for(var i=-1,o=e.length;++i<o;){var s=e[i],a=t(s);if(null!=a&&(c===r?a==a&&!ua(a):n(a,c)))var c=a,l=s}return l}function mr(e,t){var n=[];return fr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function vr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=yo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?vr(a,t-1,n,r,i):At(i,a):r||(i[i.length]=a)}return i}var yr=Li(),br=Li(!0);function wr(e,t){return e&&yr(e,t,Oa)}function Cr(e,t){return e&&br(e,t,Oa)}function Er(e,t){return St(t,(function(t){return Zs(e[t])}))}function Ir(e,t){for(var n=0,i=(t=bi(t,e)).length;null!=e&&n<i;)e=e[qo(t[n++])];return n&&n==i?e:r}function Tr(e,t,n){var r=t(e);return Vs(e)?r:At(r,n(e))}function xr(e){return null==e?e===r?"[object Undefined]":"[object Null]":lt&&lt in ke(e)?function(e){var t=Me.call(e,lt),n=e[lt];try{e[lt]=r;var i=!0}catch(e){}var o=qe.call(e);i&&(t?e[lt]=n:delete e[lt]);return o}(e):function(e){return qe.call(e)}(e)}function kr(e,t){return e>t}function Sr(e,t){return null!=e&&Me.call(e,t)}function Nr(e,t){return null!=e&&t in ke(e)}function Rr(e,t,n){for(var i=n?Rt:Nt,o=e[0].length,s=e.length,a=s,c=se(s),l=1/0,u=[];a--;){var h=e[a];a&&t&&(h=Pt(h,Gt(t))),l=bn(h.length,l),c[a]=!n&&(t||o>=120&&h.length>=120)?new Gn(a&&h):r}h=e[0];var d=-1,f=c[0];e:for(;++d<o&&u.length<l;){var p=h[d],_=t?t(p):p;if(p=n||0!==p?p:0,!(f?Jt(f,_):i(u,_,n))){for(a=s;--a;){var g=c[a];if(!(g?Jt(g,_):i(e[a],_,n)))continue e}f&&f.push(_),u.push(p)}}return u}function Pr(e,t,n){var i=null==(e=No(e,t=bi(t,e)))?e:e[qo(Xo(t))];return null==i?r:Et(i,e,n)}function Ar(e){return ra(e)&&xr(e)==m}function Or(e,t,n,i,o){return e===t||(null==e||null==t||!ra(e)&&!ra(t)?e!=e&&t!=t:function(e,t,n,i,o,s){var a=Vs(e),c=Vs(t),l=a?v:go(e),u=c?v:go(t),h=(l=l==m?x:l)==x,d=(u=u==m?x:u)==x,f=l==u;if(f&&Qs(e)){if(!Qs(t))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new Qn),a||ha(e)?no(e,t,n,i,o,s):function(e,t,n,r,i,o,s){switch(n){case D:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!o(new He(e),new He(t)));case y:case b:case T:return Ws(+e,+t);case w:return e.name==t.name&&e.message==t.message;case S:case R:return e==t+"";case I:var a=sn;case N:var c=1&r;if(a||(a=ln),e.size!=t.size&&!c)return!1;var l=s.get(e);if(l)return l==t;r|=2,s.set(e,t);var u=no(a(e),a(t),r,i,o,s);return s.delete(e),u;case P:if(qn)return qn.call(e)==qn.call(t)}return!1}(e,t,l,n,i,o,s);if(!(1&n)){var p=h&&Me.call(e,"__wrapped__"),_=d&&Me.call(t,"__wrapped__");if(p||_){var g=p?e.value():e,C=_?t.value():t;return s||(s=new Qn),o(g,C,n,i,s)}}return!!f&&(s||(s=new Qn),function(e,t,n,i,o,s){var a=1&n,c=io(e),l=c.length,u=io(t).length;if(l!=u&&!a)return!1;var h=l;for(;h--;){var d=c[h];if(!(a?d in t:Me.call(t,d)))return!1}var f=s.get(e),p=s.get(t);if(f&&p)return f==t&&p==e;var _=!0;s.set(e,t),s.set(t,e);var g=a;for(;++h<l;){var m=e[d=c[h]],v=t[d];if(i)var y=a?i(v,m,d,t,e,s):i(m,v,d,e,t,s);if(!(y===r?m===v||o(m,v,n,i,s):y)){_=!1;break}g||(g="constructor"==d)}if(_&&!g){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(_=!1)}return s.delete(e),s.delete(t),_}(e,t,n,i,o,s))}(e,t,n,i,Or,o))}function Dr(e,t,n,i){var o=n.length,s=o,a=!i;if(null==e)return!s;for(e=ke(e);o--;){var c=n[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var l=(c=n[o])[0],u=e[l],h=c[1];if(a&&c[2]){if(u===r&&!(l in e))return!1}else{var d=new Qn;if(i)var f=i(u,h,l,e,t,d);if(!(f===r?Or(h,u,3,i,d):f))return!1}}return!0}function Lr(e){return!(!na(e)||(t=e,je&&je in t))&&(Zs(e)?We:me).test(Uo(e));var t}function Mr(e){return"function"==typeof e?e:null==e?oc:"object"==typeof e?Vs(e)?Wr(e[0],e[1]):Br(e):pc(e)}function Fr(e){if(!To(e))return vn(e);var t=[];for(var n in ke(e))Me.call(e,n)&&"constructor"!=n&&t.push(n);return t}function jr(e){if(!na(e))return function(e){var t=[];if(null!=e)for(var n in ke(e))t.push(n);return t}(e);var t=To(e),n=[];for(var r in e)("constructor"!=r||!t&&Me.call(e,r))&&n.push(r);return n}function qr(e,t){return e<t}function Ur(e,t){var n=-1,r=Ks(e)?se(e.length):[];return fr(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}function Br(e){var t=ho(e);return 1==t.length&&t[0][2]?ko(t[0][0],t[0][1]):function(n){return n===e||Dr(n,e,t)}}function Wr(e,t){return Co(e)&&xo(t)?ko(qo(e),t):function(n){var i=Sa(n,e);return i===r&&i===t?Na(n,e):Or(t,i,3)}}function $r(e,t,n,i,o){e!==t&&yr(t,(function(s,a){if(o||(o=new Qn),na(s))!function(e,t,n,i,o,s,a){var c=Po(e,n),l=Po(t,n),u=a.get(l);if(u)return void tr(e,n,u);var h=s?s(c,l,n+"",e,t,a):r,d=h===r;if(d){var f=Vs(l),p=!f&&Qs(l),_=!f&&!p&&ha(l);h=l,f||p||_?Vs(c)?h=c:Gs(c)?h=Ri(c):p?(d=!1,h=Ii(l,!0)):_?(d=!1,h=xi(l,!0)):h=[]:sa(l)||Hs(l)?(h=c,Hs(c)?h=ya(c):na(c)&&!Zs(c)||(h=vo(l))):d=!1}d&&(a.set(l,h),o(h,l,i,s,a),a.delete(l));tr(e,n,h)}(e,t,a,n,$r,i,o);else{var c=i?i(Po(e,a),s,a+"",e,t,o):r;c===r&&(c=s),tr(e,a,c)}}),Da)}function zr(e,t){var n=e.length;if(n)return bo(t+=t<0?n:0,n)?e[t]:r}function Hr(e,t,n){t=t.length?Pt(t,(function(e){return Vs(e)?function(t){return Ir(t,1===e.length?e[0]:e)}:e})):[oc];var r=-1;t=Pt(t,Gt(lo()));var i=Ur(e,(function(e,n,i){var o=Pt(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;for(;++r<s;){var c=ki(i[r],o[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Vr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Ir(e,s);n(a,s)&&ei(o,bi(s,e),a)}return o}function Yr(e,t,n,r){var i=r?Ut:qt,o=-1,s=t.length,a=e;for(e===t&&(t=Ri(t)),n&&(a=Pt(e,Gt(n)));++o<s;)for(var c=0,l=t[o],u=n?n(l):l;(c=i(a,u,c,r))>-1;)a!==e&&Xe.call(a,c,1),Xe.call(e,c,1);return e}function Kr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;bo(i)?Xe.call(e,i,1):di(e,i)}}return e}function Gr(e,t){return e+Mt(En()*(t-e+1))}function Qr(e,t){var n="";if(!e||t<1||t>f)return n;do{t%2&&(n+=e),(t=Mt(t/2))&&(e+=e)}while(t);return n}function Jr(e,t){return Do(So(e,t,oc),e+"")}function Xr(e){return Xn(Wa(e))}function Zr(e,t){var n=Wa(e);return Fo(n,cr(t,0,n.length))}function ei(e,t,n,i){if(!na(e))return e;for(var o=-1,s=(t=bi(t,e)).length,a=s-1,c=e;null!=c&&++o<s;){var l=qo(t[o]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=a){var h=c[l];(u=i?i(h,l,c):r)===r&&(u=na(h)?h:bo(t[o+1])?[]:{})}nr(c,l,u),c=c[l]}return e}var ti=Pn?function(e,t){return Pn.set(e,t),e}:oc,ni=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:nc(t),writable:!0})}:oc;function ri(e){return Fo(Wa(e))}function ii(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=se(i);++r<i;)o[r]=e[r+t];return o}function oi(e,t){var n;return fr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function si(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!ua(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ai(e,t,oc,n)}function ai(e,t,n,i){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,c=null===t,l=ua(t),u=t===r;o<s;){var h=Mt((o+s)/2),d=n(e[h]),f=d!==r,p=null===d,_=d==d,g=ua(d);if(a)var m=i||_;else m=u?_&&(i||f):c?_&&f&&(i||!p):l?_&&f&&!p&&(i||!g):!p&&!g&&(i?d<=t:d<t);m?o=h+1:s=h}return bn(s,4294967294)}function ci(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Ws(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function li(e){return"number"==typeof e?e:ua(e)?p:+e}function ui(e){if("string"==typeof e)return e;if(Vs(e))return Pt(e,ui)+"";if(ua(e))return Un?Un.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hi(e,t,n){var r=-1,i=Nt,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=Rt;else if(o>=200){var l=t?null:Qi(e);if(l)return ln(l);s=!1,i=Jt,c=new Gn}else c=t?[]:a;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var d=c.length;d--;)if(c[d]===h)continue e;t&&c.push(h),a.push(u)}else i(c,h,n)||(c!==a&&c.push(h),a.push(u))}return a}function di(e,t){return null==(e=No(e,t=bi(t,e)))||delete e[qo(Xo(t))]}function fi(e,t,n,r){return ei(e,t,n(Ir(e,t)),r)}function pi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ii(e,r?0:o,r?o+1:i):ii(e,r?o+1:0,r?i:o)}function _i(e,t){var n=e;return n instanceof Hn&&(n=n.value()),Ot(t,(function(e,t){return t.func.apply(t.thisArg,At([e],t.args))}),n)}function gi(e,t,n){var r=e.length;if(r<2)return r?hi(e[0]):[];for(var i=-1,o=se(r);++i<r;)for(var s=e[i],a=-1;++a<r;)a!=i&&(o[i]=dr(o[i]||s,e[a],t,n));return hi(vr(o,1),t,n)}function mi(e,t,n){for(var i=-1,o=e.length,s=t.length,a={};++i<o;){var c=i<s?t[i]:r;n(a,e[i],c)}return a}function vi(e){return Gs(e)?e:[]}function yi(e){return"function"==typeof e?e:oc}function bi(e,t){return Vs(e)?e:Co(e,t)?[e]:jo(ba(e))}var wi=Jr;function Ci(e,t,n){var i=e.length;return n=n===r?i:n,!t&&n>=i?e:ii(e,t,n)}var Ei=dt||function(e){return ht.clearTimeout(e)};function Ii(e,t){if(t)return e.slice();var n=e.length,r=Ve?Ve(n):new e.constructor(n);return e.copy(r),r}function Ti(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function xi(e,t){var n=t?Ti(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ki(e,t){if(e!==t){var n=e!==r,i=null===e,o=e==e,s=ua(e),a=t!==r,c=null===t,l=t==t,u=ua(t);if(!c&&!u&&!s&&e>t||s&&a&&l&&!c&&!u||i&&a&&l||!n&&l||!o)return 1;if(!i&&!s&&!u&&e<t||u&&n&&o&&!i&&!s||c&&n&&o||!a&&o||!l)return-1}return 0}function Si(e,t,n,r){for(var i=-1,o=e.length,s=n.length,a=-1,c=t.length,l=yn(o-s,0),u=se(c+l),h=!r;++a<c;)u[a]=t[a];for(;++i<s;)(h||i<o)&&(u[n[i]]=e[i]);for(;l--;)u[a++]=e[i++];return u}function Ni(e,t,n,r){for(var i=-1,o=e.length,s=-1,a=n.length,c=-1,l=t.length,u=yn(o-a,0),h=se(u+l),d=!r;++i<u;)h[i]=e[i];for(var f=i;++c<l;)h[f+c]=t[c];for(;++s<a;)(d||i<o)&&(h[f+n[s]]=e[i++]);return h}function Ri(e,t){var n=-1,r=e.length;for(t||(t=se(r));++n<r;)t[n]=e[n];return t}function Pi(e,t,n,i){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var c=t[s],l=i?i(n[c],e[c],c,n,e):r;l===r&&(l=e[c]),o?sr(n,c,l):nr(n,c,l)}return n}function Ai(e,t){return function(n,r){var i=Vs(n)?It:ir,o=t?t():{};return i(n,e,lo(r,2),o)}}function Oi(e){return Jr((function(t,n){var i=-1,o=n.length,s=o>1?n[o-1]:r,a=o>2?n[2]:r;for(s=e.length>3&&"function"==typeof s?(o--,s):r,a&&wo(n[0],n[1],a)&&(s=o<3?r:s,o=1),t=ke(t);++i<o;){var c=n[i];c&&e(t,c,i,s)}return t}))}function Di(e,t){return function(n,r){if(null==n)return n;if(!Ks(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=ke(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Li(e){return function(t,n,r){for(var i=-1,o=ke(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}function Mi(e){return function(t){var n=on(t=ba(t))?hn(t):r,i=n?n[0]:t.charAt(0),o=n?Ci(n,1).join(""):t.slice(1);return i[e]()+o}}function Fi(e){return function(t){return Ot(Za(Ha(t).replace(Qe,"")),e,"")}}function ji(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Wn(e.prototype),r=e.apply(n,t);return na(r)?r:n}}function qi(e){return function(t,n,i){var o=ke(t);if(!Ks(t)){var s=lo(n,3);t=Oa(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,i);return a>-1?o[s?t[a]:a]:r}}function Ui(e){return ro((function(t){var n=t.length,o=n,s=zn.prototype.thru;for(e&&t.reverse();o--;){var a=t[o];if("function"!=typeof a)throw new Re(i);if(s&&!c&&"wrapper"==ao(a))var c=new zn([],!0)}for(o=c?o:n;++o<n;){var l=ao(a=t[o]),u="wrapper"==l?so(a):r;c=u&&Eo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[ao(u[0])].apply(c,u[3]):1==a.length&&Eo(a)?c[l]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Vs(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Bi(e,t,n,i,o,s,a,c,l,h){var d=t&u,f=1&t,p=2&t,_=24&t,g=512&t,m=p?r:ji(e);return function r(){for(var u=arguments.length,v=se(u),y=u;y--;)v[y]=arguments[y];if(_)var b=co(r),w=en(v,b);if(i&&(v=Si(v,i,o,_)),s&&(v=Ni(v,s,a,_)),u-=w,_&&u<h){var C=cn(v,b);return Ki(e,t,Bi,r.placeholder,n,v,C,c,l,h-u)}var E=f?n:this,I=p?E[e]:e;return u=v.length,c?v=Ro(v,c):g&&u>1&&v.reverse(),d&&l<u&&(v.length=l),this&&this!==ht&&this instanceof r&&(I=m||ji(I)),I.apply(E,v)}}function Wi(e,t){return function(n,r){return function(e,t,n,r){return wr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function $i(e,t){return function(n,i){var o;if(n===r&&i===r)return t;if(n!==r&&(o=n),i!==r){if(o===r)return i;"string"==typeof n||"string"==typeof i?(n=ui(n),i=ui(i)):(n=li(n),i=li(i)),o=e(n,i)}return o}}function zi(e){return ro((function(t){return t=Pt(t,Gt(lo())),Jr((function(n){var r=this;return e(t,(function(e){return Et(e,r,n)}))}))}))}function Hi(e,t){var n=(t=t===r?" ":ui(t)).length;if(n<2)return n?Qr(t,e):t;var i=Qr(t,gt(e/un(t)));return on(t)?Ci(hn(i),0,e).join(""):i.slice(0,e)}function Vi(e){return function(t,n,i){return i&&"number"!=typeof i&&wo(t,n,i)&&(n=i=r),t=_a(t),n===r?(n=t,t=0):n=_a(n),function(e,t,n,r){for(var i=-1,o=yn(gt((t-e)/(n||1)),0),s=se(o);o--;)s[r?o:++i]=e,e+=n;return s}(t,n,i=i===r?t<n?1:-1:_a(i),e)}}function Yi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=va(t),n=va(n)),e(t,n)}}function Ki(e,t,n,i,o,s,a,u,h,d){var f=8&t;t|=f?c:l,4&(t&=~(f?l:c))||(t&=-4);var p=[e,t,o,f?s:r,f?a:r,f?r:s,f?r:a,u,h,d],_=n.apply(r,p);return Eo(e)&&Ao(_,p),_.placeholder=i,Lo(_,e,t)}function Gi(e){var t=xe[e];return function(e,n){if(e=va(e),(n=null==n?0:bn(ga(n),292))&&gn(e)){var r=(ba(e)+"e").split("e");return+((r=(ba(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Qi=Sn&&1/ln(new Sn([,-0]))[1]==d?function(e){return new Sn(e)}:uc;function Ji(e){return function(t){var n=go(t);return n==I?sn(t):n==N?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xi(e,t,n,o,d,f,p,_){var g=2&t;if(!g&&"function"!=typeof e)throw new Re(i);var m=o?o.length:0;if(m||(t&=-97,o=d=r),p=p===r?p:yn(ga(p),0),_=_===r?_:ga(_),m-=d?d.length:0,t&l){var v=o,y=d;o=d=r}var b=g?r:so(e),w=[e,t,n,o,d,v,y,f,p,_];if(b&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==u&&8==n||r==u&&n==h&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?Si(l,c,t[4]):c,e[4]=l?cn(e[3],s):t[4]}(c=t[5])&&(l=e[5],e[5]=l?Ni(l,c,t[6]):c,e[6]=l?cn(e[5],s):t[6]);(c=t[7])&&(e[7]=c);r&u&&(e[8]=null==e[8]?t[8]:bn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(w,b),e=w[0],t=w[1],n=w[2],o=w[3],d=w[4],!(_=w[9]=w[9]===r?g?0:e.length:yn(w[9]-m,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==a?function(e,t,n){var i=ji(e);return function o(){for(var s=arguments.length,a=se(s),c=s,l=co(o);c--;)a[c]=arguments[c];var u=s<3&&a[0]!==l&&a[s-1]!==l?[]:cn(a,l);return(s-=u.length)<n?Ki(e,t,Bi,o.placeholder,r,a,u,r,r,n-s):Et(this&&this!==ht&&this instanceof o?i:e,this,a)}}(e,t,_):t!=c&&33!=t||d.length?Bi.apply(r,w):function(e,t,n,r){var i=1&t,o=ji(e);return function t(){for(var s=-1,a=arguments.length,c=-1,l=r.length,u=se(l+a),h=this&&this!==ht&&this instanceof t?o:e;++c<l;)u[c]=r[c];for(;a--;)u[c++]=arguments[++s];return Et(h,i?n:this,u)}}(e,t,n,o);else var C=function(e,t,n){var r=1&t,i=ji(e);return function t(){return(this&&this!==ht&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Lo((b?ti:Ao)(C,w),e,t)}function Zi(e,t,n,i){return e===r||Ws(e,Oe[n])&&!Me.call(i,n)?t:e}function eo(e,t,n,i,o,s){return na(e)&&na(t)&&(s.set(t,e),$r(e,t,r,eo,s),s.delete(t)),e}function to(e){return sa(e)?r:e}function no(e,t,n,i,o,s){var a=1&n,c=e.length,l=t.length;if(c!=l&&!(a&&l>c))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var d=-1,f=!0,p=2&n?new Gn:r;for(s.set(e,t),s.set(t,e);++d<c;){var _=e[d],g=t[d];if(i)var m=a?i(g,_,d,t,e,s):i(_,g,d,e,t,s);if(m!==r){if(m)continue;f=!1;break}if(p){if(!Lt(t,(function(e,t){if(!Jt(p,t)&&(_===e||o(_,e,n,i,s)))return p.push(t)}))){f=!1;break}}else if(_!==g&&!o(_,g,n,i,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function ro(e){return Do(So(e,r,Yo),e+"")}function io(e){return Tr(e,Oa,po)}function oo(e){return Tr(e,Da,_o)}var so=Pn?function(e){return Pn.get(e)}:uc;function ao(e){for(var t=e.name+"",n=An[t],r=Me.call(An,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function co(e){return(Me.call(Bn,"placeholder")?Bn:e).placeholder}function lo(){var e=Bn.iteratee||sc;return e=e===sc?Mr:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ho(e){for(var t=Oa(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,xo(i)]}return t}function fo(e,t){var n=function(e,t){return null==e?r:e[t]}(e,t);return Lr(n)?n:r}var po=zt?function(e){return null==e?[]:(e=ke(e),St(zt(e),(function(t){return Ge.call(e,t)})))}:mc,_o=zt?function(e){for(var t=[];e;)At(t,po(e)),e=Ye(e);return t}:mc,go=xr;function mo(e,t,n){for(var r=-1,i=(t=bi(t,e)).length,o=!1;++r<i;){var s=qo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&ta(i)&&bo(s,i)&&(Vs(e)||Hs(e))}function vo(e){return"function"!=typeof e.constructor||To(e)?{}:Wn(Ye(e))}function yo(e){return Vs(e)||Hs(e)||!!(et&&e&&e[et])}function bo(e,t){var n=typeof e;return!!(t=null==t?f:t)&&("number"==n||"symbol"!=n&&ye.test(e))&&e>-1&&e%1==0&&e<t}function wo(e,t,n){if(!na(n))return!1;var r=typeof t;return!!("number"==r?Ks(n)&&bo(t,n.length):"string"==r&&t in n)&&Ws(n[t],e)}function Co(e,t){if(Vs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ua(e))||(te.test(e)||!ee.test(e)||null!=t&&e in ke(t))}function Eo(e){var t=ao(e),n=Bn[t];if("function"!=typeof n||!(t in Hn.prototype))return!1;if(e===n)return!0;var r=so(n);return!!r&&e===r[0]}(Tn&&go(new Tn(new ArrayBuffer(1)))!=D||xn&&go(new xn)!=I||kn&&go(kn.resolve())!=k||Sn&&go(new Sn)!=N||Nn&&go(new Nn)!=A)&&(go=function(e){var t=xr(e),n=t==x?e.constructor:r,i=n?Uo(n):"";if(i)switch(i){case On:return D;case Dn:return I;case Ln:return k;case Mn:return N;case Fn:return A}return t});var Io=De?Zs:vc;function To(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Oe)}function xo(e){return e==e&&!na(e)}function ko(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==r||e in ke(n)))}}function So(e,t,n){return t=yn(t===r?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=yn(r.length-t,0),s=se(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=se(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),Et(e,this,a)}}function No(e,t){return t.length<2?e:Ir(e,ii(t,0,-1))}function Ro(e,t){for(var n=e.length,i=bn(t.length,n),o=Ri(e);i--;){var s=t[i];e[i]=bo(s,n)?o[s]:r}return e}function Po(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ao=Mo(ti),Oo=_t||function(e,t){return ht.setTimeout(e,t)},Do=Mo(ni);function Lo(e,t,n){var r=t+"";return Do(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Tt(g,(function(n){var r="_."+n[0];t&n[1]&&!Nt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ce);return t?t[1].split(le):[]}(r),n)))}function Mo(e){var t=0,n=0;return function(){var i=wn(),o=16-(i-n);if(n=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Fo(e,t){var n=-1,i=e.length,o=i-1;for(t=t===r?i:t;++n<t;){var s=Gr(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var jo=function(e){var t=Ms(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ne,(function(e,n,r,i){t.push(r?i.replace(de,"$1"):n||e)})),t}));function qo(e){if("string"==typeof e||ua(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Uo(e){if(null!=e){try{return Le.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Bo(e){if(e instanceof Hn)return e.clone();var t=new zn(e.__wrapped__,e.__chain__);return t.__actions__=Ri(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Wo=Jr((function(e,t){return Gs(e)?dr(e,vr(t,1,Gs,!0)):[]})),$o=Jr((function(e,t){var n=Xo(t);return Gs(n)&&(n=r),Gs(e)?dr(e,vr(t,1,Gs,!0),lo(n,2)):[]})),zo=Jr((function(e,t){var n=Xo(t);return Gs(n)&&(n=r),Gs(e)?dr(e,vr(t,1,Gs,!0),r,n):[]}));function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ga(n);return i<0&&(i=yn(r+i,0)),jt(e,lo(t,3),i)}function Vo(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return n!==r&&(o=ga(n),o=n<0?yn(i+o,0):bn(o,i-1)),jt(e,lo(t,3),o,!0)}function Yo(e){return(null==e?0:e.length)?vr(e,1):[]}function Ko(e){return e&&e.length?e[0]:r}var Go=Jr((function(e){var t=Pt(e,vi);return t.length&&t[0]===e[0]?Rr(t):[]})),Qo=Jr((function(e){var t=Xo(e),n=Pt(e,vi);return t===Xo(n)?t=r:n.pop(),n.length&&n[0]===e[0]?Rr(n,lo(t,2)):[]})),Jo=Jr((function(e){var t=Xo(e),n=Pt(e,vi);return(t="function"==typeof t?t:r)&&n.pop(),n.length&&n[0]===e[0]?Rr(n,r,t):[]}));function Xo(e){var t=null==e?0:e.length;return t?e[t-1]:r}var Zo=Jr(es);function es(e,t){return e&&e.length&&t&&t.length?Yr(e,t):e}var ts=ro((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return Kr(e,Pt(t,(function(e){return bo(e,n)?+e:e})).sort(ki)),r}));function ns(e){return null==e?e:In.call(e)}var rs=Jr((function(e){return hi(vr(e,1,Gs,!0))})),is=Jr((function(e){var t=Xo(e);return Gs(t)&&(t=r),hi(vr(e,1,Gs,!0),lo(t,2))})),os=Jr((function(e){var t=Xo(e);return t="function"==typeof t?t:r,hi(vr(e,1,Gs,!0),r,t)}));function ss(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(Gs(e))return t=yn(e.length,t),!0})),Yt(t,(function(t){return Pt(e,$t(t))}))}function as(e,t){if(!e||!e.length)return[];var n=ss(e);return null==t?n:Pt(n,(function(e){return Et(t,r,e)}))}var cs=Jr((function(e,t){return Gs(e)?dr(e,t):[]})),ls=Jr((function(e){return gi(St(e,Gs))})),us=Jr((function(e){var t=Xo(e);return Gs(t)&&(t=r),gi(St(e,Gs),lo(t,2))})),hs=Jr((function(e){var t=Xo(e);return t="function"==typeof t?t:r,gi(St(e,Gs),r,t)})),ds=Jr(ss);var fs=Jr((function(e){var t=e.length,n=t>1?e[t-1]:r;return n="function"==typeof n?(e.pop(),n):r,as(e,n)}));function ps(e){var t=Bn(e);return t.__chain__=!0,t}function _s(e,t){return t(e)}var gs=ro((function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,o=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&i instanceof Hn&&bo(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:_s,args:[o],thisArg:r}),new zn(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(r),e}))):this.thru(o)}));var ms=Ai((function(e,t,n){Me.call(e,n)?++e[n]:sr(e,n,1)}));var vs=qi(Ho),ys=qi(Vo);function bs(e,t){return(Vs(e)?Tt:fr)(e,lo(t,3))}function ws(e,t){return(Vs(e)?xt:pr)(e,lo(t,3))}var Cs=Ai((function(e,t,n){Me.call(e,n)?e[n].push(t):sr(e,n,[t])}));var Es=Jr((function(e,t,n){var r=-1,i="function"==typeof t,o=Ks(e)?se(e.length):[];return fr(e,(function(e){o[++r]=i?Et(t,e,n):Pr(e,t,n)})),o})),Is=Ai((function(e,t,n){sr(e,n,t)}));function Ts(e,t){return(Vs(e)?Pt:Ur)(e,lo(t,3))}var xs=Ai((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ks=Jr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&wo(e,t[0],t[1])?t=[]:n>2&&wo(t[0],t[1],t[2])&&(t=[t[0]]),Hr(e,vr(t,1),[])})),Ss=ft||function(){return ht.Date.now()};function Ns(e,t,n){return t=n?r:t,t=e&&null==t?e.length:t,Xi(e,u,r,r,r,r,t)}function Rs(e,t){var n;if("function"!=typeof t)throw new Re(i);return e=ga(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var Ps=Jr((function(e,t,n){var r=1;if(n.length){var i=cn(n,co(Ps));r|=c}return Xi(e,r,t,n,i)})),As=Jr((function(e,t,n){var r=3;if(n.length){var i=cn(n,co(As));r|=c}return Xi(t,r,e,n,i)}));function Os(e,t,n){var o,s,a,c,l,u,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new Re(i);function _(t){var n=o,i=s;return o=s=r,h=t,c=e.apply(i,n)}function g(e){return h=e,l=Oo(v,t),d?_(e):c}function m(e){var n=e-u;return u===r||n>=t||n<0||f&&e-h>=a}function v(){var e=Ss();if(m(e))return y(e);l=Oo(v,function(e){var n=t-(e-u);return f?bn(n,a-(e-h)):n}(e))}function y(e){return l=r,p&&o?_(e):(o=s=r,c)}function b(){var e=Ss(),n=m(e);if(o=arguments,s=this,u=e,n){if(l===r)return g(u);if(f)return Ei(l),l=Oo(v,t),_(u)}return l===r&&(l=Oo(v,t)),c}return t=va(t)||0,na(n)&&(d=!!n.leading,a=(f="maxWait"in n)?yn(va(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),b.cancel=function(){l!==r&&Ei(l),h=0,o=u=s=l=r},b.flush=function(){return l===r?c:y(Ss())},b}var Ds=Jr((function(e,t){return hr(e,1,t)})),Ls=Jr((function(e,t,n){return hr(e,va(t)||0,n)}));function Ms(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Re(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Ms.Cache||Kn),n}function Fs(e){if("function"!=typeof e)throw new Re(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ms.Cache=Kn;var js=wi((function(e,t){var n=(t=1==t.length&&Vs(t[0])?Pt(t[0],Gt(lo())):Pt(vr(t,1),Gt(lo()))).length;return Jr((function(r){for(var i=-1,o=bn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Et(e,this,r)}))})),qs=Jr((function(e,t){var n=cn(t,co(qs));return Xi(e,c,r,t,n)})),Us=Jr((function(e,t){var n=cn(t,co(Us));return Xi(e,l,r,t,n)})),Bs=ro((function(e,t){return Xi(e,h,r,r,r,t)}));function Ws(e,t){return e===t||e!=e&&t!=t}var $s=Yi(kr),zs=Yi((function(e,t){return e>=t})),Hs=Ar(function(){return arguments}())?Ar:function(e){return ra(e)&&Me.call(e,"callee")&&!Ge.call(e,"callee")},Vs=se.isArray,Ys=mt?Gt(mt):function(e){return ra(e)&&xr(e)==O};function Ks(e){return null!=e&&ta(e.length)&&!Zs(e)}function Gs(e){return ra(e)&&Ks(e)}var Qs=_n||vc,Js=vt?Gt(vt):function(e){return ra(e)&&xr(e)==b};function Xs(e){if(!ra(e))return!1;var t=xr(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!sa(e)}function Zs(e){if(!na(e))return!1;var t=xr(e);return t==C||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function ea(e){return"number"==typeof e&&e==ga(e)}function ta(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=f}function na(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ra(e){return null!=e&&"object"==typeof e}var ia=yt?Gt(yt):function(e){return ra(e)&&go(e)==I};function oa(e){return"number"==typeof e||ra(e)&&xr(e)==T}function sa(e){if(!ra(e)||xr(e)!=x)return!1;var t=Ye(e);if(null===t)return!0;var n=Me.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Le.call(n)==Ue}var aa=bt?Gt(bt):function(e){return ra(e)&&xr(e)==S};var ca=wt?Gt(wt):function(e){return ra(e)&&go(e)==N};function la(e){return"string"==typeof e||!Vs(e)&&ra(e)&&xr(e)==R}function ua(e){return"symbol"==typeof e||ra(e)&&xr(e)==P}var ha=Ct?Gt(Ct):function(e){return ra(e)&&ta(e.length)&&!!it[xr(e)]};var da=Yi(qr),fa=Yi((function(e,t){return e<=t}));function pa(e){if(!e)return[];if(Ks(e))return la(e)?hn(e):Ri(e);if(st&&e[st])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[st]());var t=go(e);return(t==I?sn:t==N?ln:Wa)(e)}function _a(e){return e?(e=va(e))===d||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ga(e){var t=_a(e),n=t%1;return t==t?n?t-n:t:0}function ma(e){return e?cr(ga(e),0,_):0}function va(e){if("number"==typeof e)return e;if(ua(e))return p;if(na(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=na(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Kt(e);var n=ge.test(e);return n||ve.test(e)?ct(e.slice(2),n?2:8):_e.test(e)?p:+e}function ya(e){return Pi(e,Da(e))}function ba(e){return null==e?"":ui(e)}var wa=Oi((function(e,t){if(To(t)||Ks(t))Pi(t,Oa(t),e);else for(var n in t)Me.call(t,n)&&nr(e,n,t[n])})),Ca=Oi((function(e,t){Pi(t,Da(t),e)})),Ea=Oi((function(e,t,n,r){Pi(t,Da(t),e,r)})),Ia=Oi((function(e,t,n,r){Pi(t,Oa(t),e,r)})),Ta=ro(ar);var xa=Jr((function(e,t){e=ke(e);var n=-1,i=t.length,o=i>2?t[2]:r;for(o&&wo(t[0],t[1],o)&&(i=1);++n<i;)for(var s=t[n],a=Da(s),c=-1,l=a.length;++c<l;){var u=a[c],h=e[u];(h===r||Ws(h,Oe[u])&&!Me.call(e,u))&&(e[u]=s[u])}return e})),ka=Jr((function(e){return e.push(r,eo),Et(Ma,r,e)}));function Sa(e,t,n){var i=null==e?r:Ir(e,t);return i===r?n:i}function Na(e,t){return null!=e&&mo(e,t,Nr)}var Ra=Wi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=qe.call(t)),e[t]=n}),nc(oc)),Pa=Wi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=qe.call(t)),Me.call(e,t)?e[t].push(n):e[t]=[n]}),lo),Aa=Jr(Pr);function Oa(e){return Ks(e)?Jn(e):Fr(e)}function Da(e){return Ks(e)?Jn(e,!0):jr(e)}var La=Oi((function(e,t,n){$r(e,t,n)})),Ma=Oi((function(e,t,n,r){$r(e,t,n,r)})),Fa=ro((function(e,t){var n={};if(null==e)return n;var r=!1;t=Pt(t,(function(t){return t=bi(t,e),r||(r=t.length>1),t})),Pi(e,oo(e),n),r&&(n=lr(n,7,to));for(var i=t.length;i--;)di(n,t[i]);return n}));var ja=ro((function(e,t){return null==e?{}:function(e,t){return Vr(e,t,(function(t,n){return Na(e,n)}))}(e,t)}));function qa(e,t){if(null==e)return{};var n=Pt(oo(e),(function(e){return[e]}));return t=lo(t),Vr(e,n,(function(e,n){return t(e,n[0])}))}var Ua=Ji(Oa),Ba=Ji(Da);function Wa(e){return null==e?[]:Qt(e,Oa(e))}var $a=Fi((function(e,t,n){return t=t.toLowerCase(),e+(n?za(t):t)}));function za(e){return Xa(ba(e).toLowerCase())}function Ha(e){return(e=ba(e))&&e.replace(be,tn).replace(Je,"")}var Va=Fi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ya=Fi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ka=Mi("toLowerCase");var Ga=Fi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Qa=Fi((function(e,t,n){return e+(n?" ":"")+Xa(t)}));var Ja=Fi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Xa=Mi("toUpperCase");function Za(e,t,n){return e=ba(e),(t=n?r:t)===r?function(e){return tt.test(e)}(e)?function(e){return e.match(Ze)||[]}(e):function(e){return e.match(ue)||[]}(e):e.match(t)||[]}var ec=Jr((function(e,t){try{return Et(e,r,t)}catch(e){return Xs(e)?e:new Ie(e)}})),tc=ro((function(e,t){return Tt(t,(function(t){t=qo(t),sr(e,t,Ps(e[t],e))})),e}));function nc(e){return function(){return e}}var rc=Ui(),ic=Ui(!0);function oc(e){return e}function sc(e){return Mr("function"==typeof e?e:lr(e,1))}var ac=Jr((function(e,t){return function(n){return Pr(n,e,t)}})),cc=Jr((function(e,t){return function(n){return Pr(e,n,t)}}));function lc(e,t,n){var r=Oa(t),i=Er(t,r);null!=n||na(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Er(t,Oa(t)));var o=!(na(n)&&"chain"in n&&!n.chain),s=Zs(e);return Tt(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=Ri(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,At([this.value()],arguments))})})),e}function uc(){}var hc=zi(Pt),dc=zi(kt),fc=zi(Lt);function pc(e){return Co(e)?$t(qo(e)):function(e){return function(t){return Ir(t,e)}}(e)}var _c=Vi(),gc=Vi(!0);function mc(){return[]}function vc(){return!1}var yc=$i((function(e,t){return e+t}),0),bc=Gi("ceil"),wc=$i((function(e,t){return e/t}),1),Cc=Gi("floor");var Ec,Ic=$i((function(e,t){return e*t}),1),Tc=Gi("round"),xc=$i((function(e,t){return e-t}),0);return Bn.after=function(e,t){if("function"!=typeof t)throw new Re(i);return e=ga(e),function(){if(--e<1)return t.apply(this,arguments)}},Bn.ary=Ns,Bn.assign=wa,Bn.assignIn=Ca,Bn.assignInWith=Ea,Bn.assignWith=Ia,Bn.at=Ta,Bn.before=Rs,Bn.bind=Ps,Bn.bindAll=tc,Bn.bindKey=As,Bn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Vs(e)?e:[e]},Bn.chain=ps,Bn.chunk=function(e,t,n){t=(n?wo(e,t,n):t===r)?1:yn(ga(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,a=se(gt(i/t));o<i;)a[s++]=ii(e,o,o+=t);return a},Bn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Bn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=se(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return At(Vs(n)?Ri(n):[n],vr(t,1))},Bn.cond=function(e){var t=null==e?0:e.length,n=lo();return e=t?Pt(e,(function(e){if("function"!=typeof e[1])throw new Re(i);return[n(e[0]),e[1]]})):[],Jr((function(n){for(var r=-1;++r<t;){var i=e[r];if(Et(i[0],this,n))return Et(i[1],this,n)}}))},Bn.conforms=function(e){return function(e){var t=Oa(e);return function(n){return ur(n,e,t)}}(lr(e,1))},Bn.constant=nc,Bn.countBy=ms,Bn.create=function(e,t){var n=Wn(e);return null==t?n:or(n,t)},Bn.curry=function e(t,n,i){var o=Xi(t,8,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},Bn.curryRight=function e(t,n,i){var o=Xi(t,a,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},Bn.debounce=Os,Bn.defaults=xa,Bn.defaultsDeep=ka,Bn.defer=Ds,Bn.delay=Ls,Bn.difference=Wo,Bn.differenceBy=$o,Bn.differenceWith=zo,Bn.drop=function(e,t,n){var i=null==e?0:e.length;return i?ii(e,(t=n||t===r?1:ga(t))<0?0:t,i):[]},Bn.dropRight=function(e,t,n){var i=null==e?0:e.length;return i?ii(e,0,(t=i-(t=n||t===r?1:ga(t)))<0?0:t):[]},Bn.dropRightWhile=function(e,t){return e&&e.length?pi(e,lo(t,3),!0,!0):[]},Bn.dropWhile=function(e,t){return e&&e.length?pi(e,lo(t,3),!0):[]},Bn.fill=function(e,t,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&wo(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for((n=ga(n))<0&&(n=-n>o?0:o+n),(i=i===r||i>o?o:ga(i))<0&&(i+=o),i=n>i?0:ma(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},Bn.filter=function(e,t){return(Vs(e)?St:mr)(e,lo(t,3))},Bn.flatMap=function(e,t){return vr(Ts(e,t),1)},Bn.flatMapDeep=function(e,t){return vr(Ts(e,t),d)},Bn.flatMapDepth=function(e,t,n){return n=n===r?1:ga(n),vr(Ts(e,t),n)},Bn.flatten=Yo,Bn.flattenDeep=function(e){return(null==e?0:e.length)?vr(e,d):[]},Bn.flattenDepth=function(e,t){return(null==e?0:e.length)?vr(e,t=t===r?1:ga(t)):[]},Bn.flip=function(e){return Xi(e,512)},Bn.flow=rc,Bn.flowRight=ic,Bn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Bn.functions=function(e){return null==e?[]:Er(e,Oa(e))},Bn.functionsIn=function(e){return null==e?[]:Er(e,Da(e))},Bn.groupBy=Cs,Bn.initial=function(e){return(null==e?0:e.length)?ii(e,0,-1):[]},Bn.intersection=Go,Bn.intersectionBy=Qo,Bn.intersectionWith=Jo,Bn.invert=Ra,Bn.invertBy=Pa,Bn.invokeMap=Es,Bn.iteratee=sc,Bn.keyBy=Is,Bn.keys=Oa,Bn.keysIn=Da,Bn.map=Ts,Bn.mapKeys=function(e,t){var n={};return t=lo(t,3),wr(e,(function(e,r,i){sr(n,t(e,r,i),e)})),n},Bn.mapValues=function(e,t){var n={};return t=lo(t,3),wr(e,(function(e,r,i){sr(n,r,t(e,r,i))})),n},Bn.matches=function(e){return Br(lr(e,1))},Bn.matchesProperty=function(e,t){return Wr(e,lr(t,1))},Bn.memoize=Ms,Bn.merge=La,Bn.mergeWith=Ma,Bn.method=ac,Bn.methodOf=cc,Bn.mixin=lc,Bn.negate=Fs,Bn.nthArg=function(e){return e=ga(e),Jr((function(t){return zr(t,e)}))},Bn.omit=Fa,Bn.omitBy=function(e,t){return qa(e,Fs(lo(t)))},Bn.once=function(e){return Rs(2,e)},Bn.orderBy=function(e,t,n,i){return null==e?[]:(Vs(t)||(t=null==t?[]:[t]),Vs(n=i?r:n)||(n=null==n?[]:[n]),Hr(e,t,n))},Bn.over=hc,Bn.overArgs=js,Bn.overEvery=dc,Bn.overSome=fc,Bn.partial=qs,Bn.partialRight=Us,Bn.partition=xs,Bn.pick=ja,Bn.pickBy=qa,Bn.property=pc,Bn.propertyOf=function(e){return function(t){return null==e?r:Ir(e,t)}},Bn.pull=Zo,Bn.pullAll=es,Bn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Yr(e,t,lo(n,2)):e},Bn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Yr(e,t,r,n):e},Bn.pullAt=ts,Bn.range=_c,Bn.rangeRight=gc,Bn.rearg=Bs,Bn.reject=function(e,t){return(Vs(e)?St:mr)(e,Fs(lo(t,3)))},Bn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=lo(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Kr(e,i),n},Bn.rest=function(e,t){if("function"!=typeof e)throw new Re(i);return Jr(e,t=t===r?t:ga(t))},Bn.reverse=ns,Bn.sampleSize=function(e,t,n){return t=(n?wo(e,t,n):t===r)?1:ga(t),(Vs(e)?Zn:Zr)(e,t)},Bn.set=function(e,t,n){return null==e?e:ei(e,t,n)},Bn.setWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:ei(e,t,n,i)},Bn.shuffle=function(e){return(Vs(e)?er:ri)(e)},Bn.slice=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&wo(e,t,n)?(t=0,n=i):(t=null==t?0:ga(t),n=n===r?i:ga(n)),ii(e,t,n)):[]},Bn.sortBy=ks,Bn.sortedUniq=function(e){return e&&e.length?ci(e):[]},Bn.sortedUniqBy=function(e,t){return e&&e.length?ci(e,lo(t,2)):[]},Bn.split=function(e,t,n){return n&&"number"!=typeof n&&wo(e,t,n)&&(t=n=r),(n=n===r?_:n>>>0)?(e=ba(e))&&("string"==typeof t||null!=t&&!aa(t))&&!(t=ui(t))&&on(e)?Ci(hn(e),0,n):e.split(t,n):[]},Bn.spread=function(e,t){if("function"!=typeof e)throw new Re(i);return t=null==t?0:yn(ga(t),0),Jr((function(n){var r=n[t],i=Ci(n,0,t);return r&&At(i,r),Et(e,this,i)}))},Bn.tail=function(e){var t=null==e?0:e.length;return t?ii(e,1,t):[]},Bn.take=function(e,t,n){return e&&e.length?ii(e,0,(t=n||t===r?1:ga(t))<0?0:t):[]},Bn.takeRight=function(e,t,n){var i=null==e?0:e.length;return i?ii(e,(t=i-(t=n||t===r?1:ga(t)))<0?0:t,i):[]},Bn.takeRightWhile=function(e,t){return e&&e.length?pi(e,lo(t,3),!1,!0):[]},Bn.takeWhile=function(e,t){return e&&e.length?pi(e,lo(t,3)):[]},Bn.tap=function(e,t){return t(e),e},Bn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Re(i);return na(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Os(e,t,{leading:r,maxWait:t,trailing:o})},Bn.thru=_s,Bn.toArray=pa,Bn.toPairs=Ua,Bn.toPairsIn=Ba,Bn.toPath=function(e){return Vs(e)?Pt(e,qo):ua(e)?[e]:Ri(jo(ba(e)))},Bn.toPlainObject=ya,Bn.transform=function(e,t,n){var r=Vs(e),i=r||Qs(e)||ha(e);if(t=lo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:na(e)&&Zs(o)?Wn(Ye(e)):{}}return(i?Tt:wr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Bn.unary=function(e){return Ns(e,1)},Bn.union=rs,Bn.unionBy=is,Bn.unionWith=os,Bn.uniq=function(e){return e&&e.length?hi(e):[]},Bn.uniqBy=function(e,t){return e&&e.length?hi(e,lo(t,2)):[]},Bn.uniqWith=function(e,t){return t="function"==typeof t?t:r,e&&e.length?hi(e,r,t):[]},Bn.unset=function(e,t){return null==e||di(e,t)},Bn.unzip=ss,Bn.unzipWith=as,Bn.update=function(e,t,n){return null==e?e:fi(e,t,yi(n))},Bn.updateWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:fi(e,t,yi(n),i)},Bn.values=Wa,Bn.valuesIn=function(e){return null==e?[]:Qt(e,Da(e))},Bn.without=cs,Bn.words=Za,Bn.wrap=function(e,t){return qs(yi(t),e)},Bn.xor=ls,Bn.xorBy=us,Bn.xorWith=hs,Bn.zip=ds,Bn.zipObject=function(e,t){return mi(e||[],t||[],nr)},Bn.zipObjectDeep=function(e,t){return mi(e||[],t||[],ei)},Bn.zipWith=fs,Bn.entries=Ua,Bn.entriesIn=Ba,Bn.extend=Ca,Bn.extendWith=Ea,lc(Bn,Bn),Bn.add=yc,Bn.attempt=ec,Bn.camelCase=$a,Bn.capitalize=za,Bn.ceil=bc,Bn.clamp=function(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=(n=va(n))==n?n:0),t!==r&&(t=(t=va(t))==t?t:0),cr(va(e),t,n)},Bn.clone=function(e){return lr(e,4)},Bn.cloneDeep=function(e){return lr(e,5)},Bn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:r)},Bn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:r)},Bn.conformsTo=function(e,t){return null==t||ur(e,t,Oa(t))},Bn.deburr=Ha,Bn.defaultTo=function(e,t){return null==e||e!=e?t:e},Bn.divide=wc,Bn.endsWith=function(e,t,n){e=ba(e),t=ui(t);var i=e.length,o=n=n===r?i:cr(ga(n),0,i);return(n-=t.length)>=0&&e.slice(n,o)==t},Bn.eq=Ws,Bn.escape=function(e){return(e=ba(e))&&Q.test(e)?e.replace(K,nn):e},Bn.escapeRegExp=function(e){return(e=ba(e))&&ie.test(e)?e.replace(re,"\\$&"):e},Bn.every=function(e,t,n){var i=Vs(e)?kt:_r;return n&&wo(e,t,n)&&(t=r),i(e,lo(t,3))},Bn.find=vs,Bn.findIndex=Ho,Bn.findKey=function(e,t){return Ft(e,lo(t,3),wr)},Bn.findLast=ys,Bn.findLastIndex=Vo,Bn.findLastKey=function(e,t){return Ft(e,lo(t,3),Cr)},Bn.floor=Cc,Bn.forEach=bs,Bn.forEachRight=ws,Bn.forIn=function(e,t){return null==e?e:yr(e,lo(t,3),Da)},Bn.forInRight=function(e,t){return null==e?e:br(e,lo(t,3),Da)},Bn.forOwn=function(e,t){return e&&wr(e,lo(t,3))},Bn.forOwnRight=function(e,t){return e&&Cr(e,lo(t,3))},Bn.get=Sa,Bn.gt=$s,Bn.gte=zs,Bn.has=function(e,t){return null!=e&&mo(e,t,Sr)},Bn.hasIn=Na,Bn.head=Ko,Bn.identity=oc,Bn.includes=function(e,t,n,r){e=Ks(e)?e:Wa(e),n=n&&!r?ga(n):0;var i=e.length;return n<0&&(n=yn(i+n,0)),la(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&qt(e,t,n)>-1},Bn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ga(n);return i<0&&(i=yn(r+i,0)),qt(e,t,i)},Bn.inRange=function(e,t,n){return t=_a(t),n===r?(n=t,t=0):n=_a(n),function(e,t,n){return e>=bn(t,n)&&e<yn(t,n)}(e=va(e),t,n)},Bn.invoke=Aa,Bn.isArguments=Hs,Bn.isArray=Vs,Bn.isArrayBuffer=Ys,Bn.isArrayLike=Ks,Bn.isArrayLikeObject=Gs,Bn.isBoolean=function(e){return!0===e||!1===e||ra(e)&&xr(e)==y},Bn.isBuffer=Qs,Bn.isDate=Js,Bn.isElement=function(e){return ra(e)&&1===e.nodeType&&!sa(e)},Bn.isEmpty=function(e){if(null==e)return!0;if(Ks(e)&&(Vs(e)||"string"==typeof e||"function"==typeof e.splice||Qs(e)||ha(e)||Hs(e)))return!e.length;var t=go(e);if(t==I||t==N)return!e.size;if(To(e))return!Fr(e).length;for(var n in e)if(Me.call(e,n))return!1;return!0},Bn.isEqual=function(e,t){return Or(e,t)},Bn.isEqualWith=function(e,t,n){var i=(n="function"==typeof n?n:r)?n(e,t):r;return i===r?Or(e,t,r,n):!!i},Bn.isError=Xs,Bn.isFinite=function(e){return"number"==typeof e&&gn(e)},Bn.isFunction=Zs,Bn.isInteger=ea,Bn.isLength=ta,Bn.isMap=ia,Bn.isMatch=function(e,t){return e===t||Dr(e,t,ho(t))},Bn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:r,Dr(e,t,ho(t),n)},Bn.isNaN=function(e){return oa(e)&&e!=+e},Bn.isNative=function(e){if(Io(e))throw new Ie("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Lr(e)},Bn.isNil=function(e){return null==e},Bn.isNull=function(e){return null===e},Bn.isNumber=oa,Bn.isObject=na,Bn.isObjectLike=ra,Bn.isPlainObject=sa,Bn.isRegExp=aa,Bn.isSafeInteger=function(e){return ea(e)&&e>=-9007199254740991&&e<=f},Bn.isSet=ca,Bn.isString=la,Bn.isSymbol=ua,Bn.isTypedArray=ha,Bn.isUndefined=function(e){return e===r},Bn.isWeakMap=function(e){return ra(e)&&go(e)==A},Bn.isWeakSet=function(e){return ra(e)&&"[object WeakSet]"==xr(e)},Bn.join=function(e,t){return null==e?"":mn.call(e,t)},Bn.kebabCase=Va,Bn.last=Xo,Bn.lastIndexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return n!==r&&(o=(o=ga(n))<0?yn(i+o,0):bn(o,i-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):jt(e,Bt,o,!0)},Bn.lowerCase=Ya,Bn.lowerFirst=Ka,Bn.lt=da,Bn.lte=fa,Bn.max=function(e){return e&&e.length?gr(e,oc,kr):r},Bn.maxBy=function(e,t){return e&&e.length?gr(e,lo(t,2),kr):r},Bn.mean=function(e){return Wt(e,oc)},Bn.meanBy=function(e,t){return Wt(e,lo(t,2))},Bn.min=function(e){return e&&e.length?gr(e,oc,qr):r},Bn.minBy=function(e,t){return e&&e.length?gr(e,lo(t,2),qr):r},Bn.stubArray=mc,Bn.stubFalse=vc,Bn.stubObject=function(){return{}},Bn.stubString=function(){return""},Bn.stubTrue=function(){return!0},Bn.multiply=Ic,Bn.nth=function(e,t){return e&&e.length?zr(e,ga(t)):r},Bn.noConflict=function(){return ht._===this&&(ht._=Be),this},Bn.noop=uc,Bn.now=Ss,Bn.pad=function(e,t,n){e=ba(e);var r=(t=ga(t))?un(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Hi(Mt(i),n)+e+Hi(gt(i),n)},Bn.padEnd=function(e,t,n){e=ba(e);var r=(t=ga(t))?un(e):0;return t&&r<t?e+Hi(t-r,n):e},Bn.padStart=function(e,t,n){e=ba(e);var r=(t=ga(t))?un(e):0;return t&&r<t?Hi(t-r,n)+e:e},Bn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Cn(ba(e).replace(oe,""),t||0)},Bn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&wo(e,t,n)&&(t=n=r),n===r&&("boolean"==typeof t?(n=t,t=r):"boolean"==typeof e&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=_a(e),t===r?(t=e,e=0):t=_a(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var o=En();return bn(e+o*(t-e+at("1e-"+((o+"").length-1))),t)}return Gr(e,t)},Bn.reduce=function(e,t,n){var r=Vs(e)?Ot:Ht,i=arguments.length<3;return r(e,lo(t,4),n,i,fr)},Bn.reduceRight=function(e,t,n){var r=Vs(e)?Dt:Ht,i=arguments.length<3;return r(e,lo(t,4),n,i,pr)},Bn.repeat=function(e,t,n){return t=(n?wo(e,t,n):t===r)?1:ga(t),Qr(ba(e),t)},Bn.replace=function(){var e=arguments,t=ba(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Bn.result=function(e,t,n){var i=-1,o=(t=bi(t,e)).length;for(o||(o=1,e=r);++i<o;){var s=null==e?r:e[qo(t[i])];s===r&&(i=o,s=n),e=Zs(s)?s.call(e):s}return e},Bn.round=Tc,Bn.runInContext=e,Bn.sample=function(e){return(Vs(e)?Xn:Xr)(e)},Bn.size=function(e){if(null==e)return 0;if(Ks(e))return la(e)?un(e):e.length;var t=go(e);return t==I||t==N?e.size:Fr(e).length},Bn.snakeCase=Ga,Bn.some=function(e,t,n){var i=Vs(e)?Lt:oi;return n&&wo(e,t,n)&&(t=r),i(e,lo(t,3))},Bn.sortedIndex=function(e,t){return si(e,t)},Bn.sortedIndexBy=function(e,t,n){return ai(e,t,lo(n,2))},Bn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=si(e,t);if(r<n&&Ws(e[r],t))return r}return-1},Bn.sortedLastIndex=function(e,t){return si(e,t,!0)},Bn.sortedLastIndexBy=function(e,t,n){return ai(e,t,lo(n,2),!0)},Bn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=si(e,t,!0)-1;if(Ws(e[n],t))return n}return-1},Bn.startCase=Qa,Bn.startsWith=function(e,t,n){return e=ba(e),n=null==n?0:cr(ga(n),0,e.length),t=ui(t),e.slice(n,n+t.length)==t},Bn.subtract=xc,Bn.sum=function(e){return e&&e.length?Vt(e,oc):0},Bn.sumBy=function(e,t){return e&&e.length?Vt(e,lo(t,2)):0},Bn.template=function(e,t,n){var i=Bn.templateSettings;n&&wo(e,t,n)&&(t=r),e=ba(e),t=Ea({},t,i,Zi);var o,s,a=Ea({},t.imports,i.imports,Zi),c=Oa(a),l=Qt(a,c),u=0,h=t.interpolate||we,d="__p += '",f=Se((t.escape||we).source+"|"+h.source+"|"+(h===Z?fe:we).source+"|"+(t.evaluate||we).source+"|$","g"),p="//# sourceURL="+(Me.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(f,(function(t,n,r,i,a,c){return r||(r=i),d+=e.slice(u,c).replace(Ce,rn),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),d+="';\n";var _=Me.call(t,"variable")&&t.variable;if(_){if(he.test(_))throw new Ie("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(z,""):d).replace(H,"$1").replace(V,"$1;"),d="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=ec((function(){return Te(c,p+"return "+d).apply(r,l)}));if(g.source=d,Xs(g))throw g;return g},Bn.times=function(e,t){if((e=ga(e))<1||e>f)return[];var n=_,r=bn(e,_);t=lo(t),e-=_;for(var i=Yt(r,t);++n<e;)t(n);return i},Bn.toFinite=_a,Bn.toInteger=ga,Bn.toLength=ma,Bn.toLower=function(e){return ba(e).toLowerCase()},Bn.toNumber=va,Bn.toSafeInteger=function(e){return e?cr(ga(e),-9007199254740991,f):0===e?e:0},Bn.toString=ba,Bn.toUpper=function(e){return ba(e).toUpperCase()},Bn.trim=function(e,t,n){if((e=ba(e))&&(n||t===r))return Kt(e);if(!e||!(t=ui(t)))return e;var i=hn(e),o=hn(t);return Ci(i,Xt(i,o),Zt(i,o)+1).join("")},Bn.trimEnd=function(e,t,n){if((e=ba(e))&&(n||t===r))return e.slice(0,dn(e)+1);if(!e||!(t=ui(t)))return e;var i=hn(e);return Ci(i,0,Zt(i,hn(t))+1).join("")},Bn.trimStart=function(e,t,n){if((e=ba(e))&&(n||t===r))return e.replace(oe,"");if(!e||!(t=ui(t)))return e;var i=hn(e);return Ci(i,Xt(i,hn(t))).join("")},Bn.truncate=function(e,t){var n=30,i="...";if(na(t)){var o="separator"in t?t.separator:o;n="length"in t?ga(t.length):n,i="omission"in t?ui(t.omission):i}var s=(e=ba(e)).length;if(on(e)){var a=hn(e);s=a.length}if(n>=s)return e;var c=n-un(i);if(c<1)return i;var l=a?Ci(a,0,c).join(""):e.slice(0,c);if(o===r)return l+i;if(a&&(c+=l.length-c),aa(o)){if(e.slice(c).search(o)){var u,h=l;for(o.global||(o=Se(o.source,ba(pe.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var d=u.index;l=l.slice(0,d===r?c:d)}}else if(e.indexOf(ui(o),c)!=c){var f=l.lastIndexOf(o);f>-1&&(l=l.slice(0,f))}return l+i},Bn.unescape=function(e){return(e=ba(e))&&G.test(e)?e.replace(Y,fn):e},Bn.uniqueId=function(e){var t=++Fe;return ba(e)+t},Bn.upperCase=Ja,Bn.upperFirst=Xa,Bn.each=bs,Bn.eachRight=ws,Bn.first=Ko,lc(Bn,(Ec={},wr(Bn,(function(e,t){Me.call(Bn.prototype,t)||(Ec[t]=e)})),Ec),{chain:!1}),Bn.VERSION="4.17.21",Tt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Bn[e].placeholder=Bn})),Tt(["drop","take"],(function(e,t){Hn.prototype[e]=function(n){n=n===r?1:yn(ga(n),0);var i=this.__filtered__&&!t?new Hn(this):this.clone();return i.__filtered__?i.__takeCount__=bn(n,i.__takeCount__):i.__views__.push({size:bn(n,_),type:e+(i.__dir__<0?"Right":"")}),i},Hn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Tt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Hn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:lo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Tt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Hn.prototype[e]=function(){return this[n](1).value()[0]}})),Tt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Hn.prototype[e]=function(){return this.__filtered__?new Hn(this):this[n](1)}})),Hn.prototype.compact=function(){return this.filter(oc)},Hn.prototype.find=function(e){return this.filter(e).head()},Hn.prototype.findLast=function(e){return this.reverse().find(e)},Hn.prototype.invokeMap=Jr((function(e,t){return"function"==typeof e?new Hn(this):this.map((function(n){return Pr(n,e,t)}))})),Hn.prototype.reject=function(e){return this.filter(Fs(lo(e)))},Hn.prototype.slice=function(e,t){e=ga(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Hn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(n=(t=ga(t))<0?n.dropRight(-t):n.take(t-e)),n)},Hn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Hn.prototype.toArray=function(){return this.take(_)},wr(Hn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=Bn[i?"take"+("last"==t?"Right":""):t],s=i||/^find/.test(t);o&&(Bn.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,c=t instanceof Hn,l=a[0],u=c||Vs(t),h=function(e){var t=o.apply(Bn,At([e],a));return i&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=s&&!d,_=c&&!f;if(!s&&u){t=_?t:new Hn(this);var g=e.apply(t,a);return g.__actions__.push({func:_s,args:[h],thisArg:r}),new zn(g,d)}return p&&_?e.apply(this,a):(g=this.thru(h),p?i?g.value()[0]:g.value():g)})})),Tt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Pe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Bn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Vs(i)?i:[],e)}return this[n]((function(n){return t.apply(Vs(n)?n:[],e)}))}})),wr(Hn.prototype,(function(e,t){var n=Bn[t];if(n){var r=n.name+"";Me.call(An,r)||(An[r]=[]),An[r].push({name:t,func:n})}})),An[Bi(r,2).name]=[{name:"wrapper",func:r}],Hn.prototype.clone=function(){var e=new Hn(this.__wrapped__);return e.__actions__=Ri(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ri(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ri(this.__views__),e},Hn.prototype.reverse=function(){if(this.__filtered__){var e=new Hn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Hn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Vs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=bn(t,e+s);break;case"takeRight":e=yn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,l=r?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=bn(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return _i(e,this.__actions__);var p=[];e:for(;c--&&d<f;){for(var _=-1,g=e[l+=t];++_<h;){var m=u[_],v=m.iteratee,y=m.type,b=v(g);if(2==y)g=b;else if(!b){if(1==y)continue e;break e}}p[d++]=g}return p},Bn.prototype.at=gs,Bn.prototype.chain=function(){return ps(this)},Bn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},Bn.prototype.next=function(){this.__values__===r&&(this.__values__=pa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?r:this.__values__[this.__index__++]}},Bn.prototype.plant=function(e){for(var t,n=this;n instanceof $n;){var i=Bo(n);i.__index__=0,i.__values__=r,t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},Bn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Hn){var t=e;return this.__actions__.length&&(t=new Hn(this)),(t=t.reverse()).__actions__.push({func:_s,args:[ns],thisArg:r}),new zn(t,this.__chain__)}return this.thru(ns)},Bn.prototype.toJSON=Bn.prototype.valueOf=Bn.prototype.value=function(){return _i(this.__wrapped__,this.__actions__)},Bn.prototype.first=Bn.prototype.head,st&&(Bn.prototype[st]=function(){return this}),Bn}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ht._=pn,define((function(){return pn}))):ft?((ft.exports=pn)._=pn,dt._=pn):ht._=pn}).call(this)}));const s=["module","nomodule"];function a(e){if(!e.match(/.+\.[m]?js$/))throw new Error(o(`Unsupported type for bundle "${e}": .js or .mjs expected.`))}function c(e){if(!e||!p(e.path))throw new Error(o('Expected route config to be an object with a "path" string property, or an array of such objects'));const t=e.bundle,n=["component","redirect","bundle"];if(!(f(e.action)||Array.isArray(e.children)||f(e.children)||d(t)||n.some((t=>p(e[t])))))throw new Error(o(`Expected route config "${e.path}" to include either "${n.join('", "')}" or "action" function but none found.`));if(t)if(p(t))a(t);else{if(!s.some((e=>e in t)))throw new Error(o('Expected route bundle to include either "nomodule" or "module" keys, or both'));s.forEach((e=>e in t&&a(t[e])))}e.redirect&&["bundle","component"].forEach((t=>{t in e&&console.warn(o(`Route config "${e.path}" has both "redirect" and "${t}" properties, and "redirect" will always override the latter. Did you mean to only use "${t}"?`))}))}function l(e){i(e).forEach((e=>c(e)))}function u(e,t){let n=document.head.querySelector('script[src="'+e+'"][async]');return n||(n=document.createElement("script"),n.setAttribute("src",e),"module"===t?n.setAttribute("type","module"):"nomodule"===t&&n.setAttribute("nomodule",""),n.async=!0),new Promise(((e,t)=>{n.onreadystatechange=n.onload=t=>{n.__dynamicImportLoaded=!0,e(t)},n.onerror=e=>{n.parentNode&&n.parentNode.removeChild(n),t(e)},null===n.parentNode?document.head.appendChild(n):n.__dynamicImportLoaded&&e()}))}function h(e,t){return!window.dispatchEvent(new CustomEvent(`vaadin-router-${e}`,{cancelable:"go"===e,detail:t}))}function d(e){return"object"==typeof e&&!!e}function f(e){return"function"==typeof e}function p(e){return"string"==typeof e}function _(e){const t=new Error(o(`Page not found (${e.pathname})`));return t.context=e,t.code=404,t}const g=new class{};function m(e){if(e.defaultPrevented)return;if(0!==e.button)return;if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)return;let t=e.target;const n=e.composedPath?e.composedPath():e.path||[];for(let e=0;e<n.length;e++){const r=n[e];if(r.nodeName&&"a"===r.nodeName.toLowerCase()){t=r;break}}for(;t&&"a"!==t.nodeName.toLowerCase();)t=t.parentNode;if(!t||"a"!==t.nodeName.toLowerCase())return;if(t.target&&"_self"!==t.target.toLowerCase())return;if(t.hasAttribute("download"))return;if(t.hasAttribute("router-ignore"))return;if(t.pathname===window.location.pathname&&""!==t.hash)return;const r=t.origin||function(e){const t=e.port,n=e.protocol;return`${n}//${"http:"===n&&"80"===t||"https:"===n&&"443"===t?e.hostname:e.host}`}(t);if(r!==window.location.origin)return;const{pathname:i,search:o,hash:s}=t;h("go",{pathname:i,search:o,hash:s})&&(e.preventDefault(),e&&"click"===e.type&&window.scrollTo(0,0))}const v={activate(){window.document.addEventListener("click",m)},inactivate(){window.document.removeEventListener("click",m)}};function y(e){if("vaadin-router-ignore"===e.state)return;const{pathname:t,search:n,hash:r}=window.location;h("go",{pathname:t,search:n,hash:r})}/Trident/.test(navigator.userAgent)&&!f(window.PopStateEvent)&&(window.PopStateEvent=function(e,t){t=t||{};var n=document.createEvent("Event");return n.initEvent(e,Boolean(t.bubbles),Boolean(t.cancelable)),n.state=t.state||null,n},window.PopStateEvent.prototype=window.Event.prototype);const b={activate(){window.addEventListener("popstate",y)},inactivate(){window.removeEventListener("popstate",y)}};var w=O,C=k,E=function(e,t){return S(k(e,t))},I=S,T=A,x=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function k(e,t){for(var n,r=[],i=0,o=0,s="",a=t&&t.delimiter||"/",c=t&&t.delimiters||"./",l=!1;null!==(n=x.exec(e));){var u=n[0],h=n[1],d=n.index;if(s+=e.slice(o,d),o=d+u.length,h)s+=h[1],l=!0;else{var f="",p=e[o],_=n[2],g=n[3],m=n[4],v=n[5];if(!l&&s.length){var y=s.length-1;c.indexOf(s[y])>-1&&(f=s[y],s=s.slice(0,y))}s&&(r.push(s),s="",l=!1);var b=""!==f&&void 0!==p&&p!==f,w="+"===v||"*"===v,C="?"===v||"*"===v,E=f||a,I=g||m;r.push({name:_||i++,prefix:f,delimiter:E,optional:C,repeat:w,partial:b,pattern:I?R(I):"[^"+N(E)+"]+?"})}}return(s||o<e.length)&&r.push(s+e.substr(o)),r}function S(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,r){for(var i="",o=r&&r.encode||encodeURIComponent,s=0;s<e.length;s++){var a=e[s];if("string"!=typeof a){var c,l=n?n[a.name]:void 0;if(Array.isArray(l)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===l.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var u=0;u<l.length;u++){if(c=o(l[u],a),!t[s].test(c))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');i+=(0===u?a.prefix:a.delimiter)+c}}else if("string"!=typeof l&&"number"!=typeof l&&"boolean"!=typeof l){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"));a.partial&&(i+=a.prefix)}else{if(c=o(String(l),a),!t[s].test(c))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+c+'"');i+=a.prefix+c}}else i+=a}return i}}function N(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function R(e){return e.replace(/([=!:$/()])/g,"\\$1")}function P(e){return e&&e.sensitive?"":"i"}function A(e,t,n){for(var r=(n=n||{}).strict,i=!1!==n.start,o=!1!==n.end,s=N(n.delimiter||"/"),a=n.delimiters||"./",c=[].concat(n.endsWith||[]).map(N).concat("$").join("|"),l=i?"^":"",u=0===e.length,h=0;h<e.length;h++){var d=e[h];if("string"==typeof d)l+=N(d),u=h===e.length-1&&a.indexOf(d[d.length-1])>-1;else{var f=d.repeat?"(?:"+d.pattern+")(?:"+N(d.delimiter)+"(?:"+d.pattern+"))*":d.pattern;t&&t.push(d),d.optional?d.partial?l+=N(d.prefix)+"("+f+")?":l+="(?:"+N(d.prefix)+"("+f+"))?":l+=N(d.prefix)+"("+f+")"}}return o?(r||(l+="(?:"+s+")?"),l+="$"===c?"$":"(?="+c+")"):(r||(l+="(?:"+s+"(?="+c+"))?"),u||(l+="(?="+s+"|"+c+")")),new RegExp(l,P(n))}function O(e,t,n){return e instanceof RegExp?function(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(O(e[i],t,n).source);return new RegExp("(?:"+r.join("|")+")",P(n))}(e,t,n):function(e,t,n){return A(k(e,n),t,n)}(e,t,n)}w.parse=C,w.compile=E,w.tokensToFunction=I,w.tokensToRegExp=T;const{hasOwnProperty:D}=Object.prototype,L=new Map;function M(e){try{return decodeURIComponent(e)}catch(t){return e}}function F(e,t,n,r,i){let o,s,a=0,c=e.path||"";return"/"===c.charAt(0)&&(n&&(c=c.substr(1)),n=!0),{next(l){if(e===l)return{done:!0};const u=e.__children=e.__children||e.children;if(!o&&(o=function(e,t,n,r,i){const o=`${e}|${n=!!n}`;let s=L.get(o);if(!s){const t=[];s={keys:t,pattern:w(e,t,{end:n,strict:""===e})},L.set(o,s)}const a=s.pattern.exec(t);if(!a)return null;const c=Object.assign({},i);for(let e=1;e<a.length;e++){const t=s.keys[e-1],n=t.name,r=a[e];void 0===r&&D.call(c,n)||(t.repeat?c[n]=r?r.split(t.delimiter).map(M):[]:c[n]=r?M(r):r)}return{path:a[0],keys:(r||[]).concat(s.keys),params:c}}(c,t,!u,r,i),o))return{done:!1,value:{route:e,keys:o.keys,params:o.params,path:o.path}};if(o&&u)for(;a<u.length;){if(!s){const r=u[a];r.parent=e;let i=o.path.length;i>0&&"/"===t.charAt(i)&&(i+=1),s=F(r,t.substr(i),n,o.keys,o.params)}const r=s.next(l);if(!r.done)return{done:!1,value:r.value};s=null,a++}return{done:!0}}}}function j(e){if(f(e.route.action))return e.route.action(e)}L.set("|false",{keys:[],pattern:/(?:)/});class q{constructor(e,t={}){if(Object(e)!==e)throw new TypeError("Invalid routes");this.baseUrl=t.baseUrl||"",this.errorHandler=t.errorHandler,this.resolveRoute=t.resolveRoute||j,this.context=Object.assign({resolver:this},t.context),this.root=Array.isArray(e)?{path:"",__children:e,parent:null,__synthetic:!0}:e,this.root.parent=null}getRoutes(){return[...this.root.__children]}setRoutes(e){l(e);const t=[...i(e)];this.root.__children=t}addRoutes(e){return l(e),this.root.__children.push(...i(e)),this.getRoutes()}removeRoutes(){this.setRoutes([])}resolve(e){const t=Object.assign({},this.context,p(e)?{pathname:e}:e),n=F(this.root,this.__normalizePathname(t.pathname),this.baseUrl),r=this.resolveRoute;let i=null,o=null,s=t;function a(e,c=i.value.route,l){const u=null===l&&i.value.route;return i=o||n.next(u),o=null,e||!i.done&&function(e,t){let n=t;for(;n;)if(n=n.parent,n===e)return!0;return!1}(c,i.value.route)?i.done?Promise.reject(_(t)):(s=Object.assign(s?{chain:s.chain?s.chain.slice(0):[]}:{},t,i.value),function(e,t){const{route:n,path:r}=t;if(n&&!n.__synthetic){const t={path:r,route:n};if(e.chain){if(n.parent){let t=e.chain.length;for(;t--&&e.chain[t].route&&e.chain[t].route!==n.parent;)e.chain.pop()}}else e.chain=[];e.chain.push(t)}}(s,i.value),Promise.resolve(r(s)).then((t=>null!=t&&t!==g?(s.result=t.result||t,s):a(e,c,t)))):(o=i,Promise.resolve(g))}return t.next=a,Promise.resolve().then((()=>a(!0,this.root))).catch((e=>{const t=function(e){let t=`Path '${e.pathname}' is not properly resolved due to an error.`;const n=(e.route||{}).path;return n&&(t+=` Resolution had failed on route: '${n}'`),t}(s);if(e?console.warn(t):e=new Error(t),e.context=e.context||s,e instanceof DOMException||(e.code=e.code||500),this.errorHandler)return s.result=this.errorHandler(e),s;throw e}))}static __createUrl(e,t){return new URL(e,t)}get __effectiveBaseUrl(){return this.baseUrl?this.constructor.__createUrl(this.baseUrl,document.baseURI||document.URL).href.replace(/[^\/]*$/,""):""}__normalizePathname(e){if(!this.baseUrl)return e;const t=this.__effectiveBaseUrl,n=this.constructor.__createUrl(e,t).href;return n.slice(0,t.length)===t?n.slice(t.length):void 0}}q.pathToRegexp=w;const{pathToRegexp:U}=q,B=new Map;function W(e,t,n){const r=t.name||t.component;if(r&&(e.has(r)?e.get(r).push(t):e.set(r,[t])),Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];i.parent=t,W(e,i,i.__children||i.children)}}function $(e,t){const n=e.get(t);if(n&&n.length>1)throw new Error(`Duplicate route with name "${t}". Try seting unique 'name' route properties.`);return n&&n[0]}function z(e){let t=e.path;return t=Array.isArray(t)?t[0]:t,void 0!==t?t:""}function H(e,t={}){if(!(e instanceof q))throw new TypeError("An instance of Resolver is expected");const n=new Map;return(r,i)=>{let o=$(n,r);if(!o&&(n.clear(),W(n,e.root,e.root.__children),o=$(n,r),!o))throw new Error(`Route "${r}" not found`);let s=B.get(o.fullPath);if(!s){let e=z(o),t=o.parent;for(;t;){const n=z(t);n&&(e=n.replace(/\/$/,"")+"/"+e.replace(/^\//,"")),t=t.parent}const n=U.parse(e),r=U.tokensToFunction(n),i=Object.create(null);for(let e=0;e<n.length;e++)p(n[e])||(i[n[e].name]=!0);s={toPath:r,keys:i},B.set(e,s),o.fullPath=e}let a=s.toPath(i,t)||"/";if(t.stringifyQueryParams&&i){const e={},n=Object.keys(i);for(let t=0;t<n.length;t++){const r=n[t];s.keys[r]||(e[r]=i[r])}const r=t.stringifyQueryParams(e);r&&(a+="?"===r.charAt(0)?r:`?${r}`)}return a}}let V=[];function Y(e,t){return e.classList.add(t),new Promise((n=>{if((e=>{const t=getComputedStyle(e).getPropertyValue("animation-name");return t&&"none"!==t})(e)){const r=e.getBoundingClientRect(),i=`height: ${r.bottom-r.top}px; width: ${r.right-r.left}px`;e.setAttribute("style",`position: absolute; ${i}`),((e,t)=>{const n=()=>{e.removeEventListener("animationend",n),t()};e.addEventListener("animationend",n)})(e,(()=>{e.classList.remove(t),e.removeAttribute("style"),n()}))}else e.classList.remove(t),n()}))}function K(e){return null!=e}function G({pathname:e="",search:t="",hash:n="",chain:r=[],params:i={},redirectFrom:o,resolver:s},a){const c=r.map((e=>e.route));return{baseUrl:s&&s.baseUrl||"",pathname:e,search:t,hash:n,routes:c,route:a||c.length&&c[c.length-1]||null,params:i,redirectFrom:o,getUrl:(e={})=>ee(ne.pathToRegexp.compile(te(c))(Object.assign({},i,e)),s)}}function Q(e,t){const n=Object.assign({},e.params);return{redirect:{pathname:t,from:e.pathname,params:n}}}function J(e,t,n){if(f(e))return e.apply(n,t)}function X(e,t,n){return r=>r&&(r.cancel||r.redirect)?r:n?J(n[e],t,n):void 0}function Z(e){if(e&&e.length){const t=e[0].parentNode;for(let n=0;n<e.length;n++)t.removeChild(e[n])}}function ee(e,t){const n=t.__effectiveBaseUrl;return n?t.constructor.__createUrl(e.replace(/^\//,""),n).pathname:e}function te(e){return e.map((e=>e.path)).reduce(((e,t)=>t.length?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):e),"")}class ne extends q{constructor(e,t){const n=document.head.querySelector("base"),r=n&&n.getAttribute("href");super([],Object.assign({baseUrl:r&&q.__createUrl(r,document.URL).pathname.replace(/[^\/]*$/,"")},t)),this.resolveRoute=e=>this.__resolveRoute(e);const i=ne.NavigationTrigger;ne.setTriggers.apply(ne,Object.keys(i).map((e=>i[e]))),this.baseUrl,this.ready,this.ready=Promise.resolve(e),this.location,this.location=G({resolver:this}),this.__lastStartedRenderId=0,this.__navigationEventHandler=this.__onNavigationEvent.bind(this),this.setOutlet(e),this.subscribe(),this.__createdByRouter=new WeakMap,this.__addedByRouter=new WeakMap}__resolveRoute(e){const t=e.route;let n=Promise.resolve();f(t.children)&&(n=n.then((()=>t.children(function(e){const t=Object.assign({},e);return delete t.next,t}(e)))).then((e=>{K(e)||f(t.children)||(e=t.children),function(e,t){if(!Array.isArray(e)&&!d(e))throw new Error(o(`Incorrect "children" value for the route ${t.path}: expected array or object, but got ${e}`));t.__children=[];const n=i(e);for(let e=0;e<n.length;e++)c(n[e]),t.__children.push(n[e])}(e,t)})));const r={redirect:t=>Q(e,t),component:e=>{const t=document.createElement(e);return this.__createdByRouter.set(t,!0),t}};return n.then((()=>{if(this.__isLatestRender(e))return J(t.action,[e,r],t)})).then((e=>{return K(e)&&(e instanceof HTMLElement||e.redirect||e===g)?e:p(t.redirect)?r.redirect(t.redirect):t.bundle?(n=t.bundle,p(n)?u(n):Promise.race(s.filter((e=>e in n)).map((e=>u(n[e],e))))).then((()=>{}),(()=>{throw new Error(o(`Bundle not found: ${t.bundle}. Check if the file name is correct`))})):void 0;var n})).then((e=>K(e)?e:p(t.component)?r.component(t.component):void 0))}setOutlet(e){e&&this.__ensureOutlet(e),this.__outlet=e}getOutlet(){return this.__outlet}setRoutes(e,t=!1){return this.__previousContext=void 0,this.__urlForName=void 0,super.setRoutes(e),t||this.__onNavigationEvent(),this.ready}render(e,t){const n=++this.__lastStartedRenderId,r=Object.assign({search:"",hash:""},p(e)?{pathname:e}:e,{__renderId:n});return this.ready=this.resolve(r).then((e=>this.__fullyResolveChain(e))).then((e=>{if(this.__isLatestRender(e)){const r=this.__previousContext;if(e===r)return this.__updateBrowserHistory(r,!0),this.location;if(this.location=G(e),t&&this.__updateBrowserHistory(e,1===n),h("location-changed",{router:this,location:this.location}),e.__skipAttach)return this.__copyUnchangedElements(e,r),this.__previousContext=e,this.location;this.__addAppearingContent(e,r);const i=this.__animateIfNeeded(e);return this.__runOnAfterEnterCallbacks(e),this.__runOnAfterLeaveCallbacks(e,r),i.then((()=>{if(this.__isLatestRender(e))return this.__removeDisappearingContent(),this.__previousContext=e,this.location}))}})).catch((e=>{if(n===this.__lastStartedRenderId)throw t&&this.__updateBrowserHistory(r),Z(this.__outlet&&this.__outlet.children),this.location=G(Object.assign(r,{resolver:this})),h("error",Object.assign({router:this,error:e},r)),e})),this.ready}__fullyResolveChain(e,t=e){return this.__findComponentContextAfterAllRedirects(t).then((n=>{const r=n!==t?n:e,i=ee(te(n.chain),n.resolver)===n.pathname,o=(e,t=e.route,n)=>e.next(void 0,t,n).then((n=>null===n||n===g?i?e:null!==t.parent?o(e,t.parent,n):n:n));return o(n).then((e=>{if(null===e||e===g)throw _(r);return e&&e!==g&&e!==n?this.__fullyResolveChain(r,e):this.__amendWithOnBeforeCallbacks(n)}))}))}__findComponentContextAfterAllRedirects(e){const t=e.result;return t instanceof HTMLElement?(function(e,t){t.location=G(e);const n=e.chain.map((e=>e.route)).indexOf(e.route);e.chain[n].element=t}(e,t),Promise.resolve(e)):t.redirect?this.__redirect(t.redirect,e.__redirectCount,e.__renderId).then((e=>this.__findComponentContextAfterAllRedirects(e))):t instanceof Error?Promise.reject(t):Promise.reject(new Error(o(`Invalid route resolution result for path "${e.pathname}". Expected redirect object or HTML element, but got: "${function(e){if("object"!=typeof e)return String(e);const t=Object.prototype.toString.call(e).match(/ (.*)\]$/)[1];return"Object"===t||"Array"===t?`${t} ${JSON.stringify(e)}`:t}(t)}". Double check the action return value for the route.`)))}__amendWithOnBeforeCallbacks(e){return this.__runOnBeforeCallbacks(e).then((t=>t===this.__previousContext||t===e?t:this.__fullyResolveChain(t)))}__runOnBeforeCallbacks(e){const t=this.__previousContext||{},n=t.chain||[],r=e.chain;let i=Promise.resolve();const o=()=>({cancel:!0}),s=t=>Q(e,t);if(e.__divergedChainIndex=0,e.__skipAttach=!1,n.length){for(let t=0;t<Math.min(n.length,r.length)&&(n[t].route===r[t].route&&(n[t].path===r[t].path||n[t].element===r[t].element)&&this.__isReusableElement(n[t].element,r[t].element));t=++e.__divergedChainIndex);if(e.__skipAttach=r.length===n.length&&e.__divergedChainIndex==r.length&&this.__isReusableElement(e.result,t.result),e.__skipAttach){for(let t=r.length-1;t>=0;t--)i=this.__runOnBeforeLeaveCallbacks(i,e,{prevent:o},n[t]);for(let t=0;t<r.length;t++)i=this.__runOnBeforeEnterCallbacks(i,e,{prevent:o,redirect:s},r[t]),n[t].element.location=G(e,n[t].route)}else for(let t=n.length-1;t>=e.__divergedChainIndex;t--)i=this.__runOnBeforeLeaveCallbacks(i,e,{prevent:o},n[t])}if(!e.__skipAttach)for(let t=0;t<r.length;t++)t<e.__divergedChainIndex?t<n.length&&n[t].element&&(n[t].element.location=G(e,n[t].route)):(i=this.__runOnBeforeEnterCallbacks(i,e,{prevent:o,redirect:s},r[t]),r[t].element&&(r[t].element.location=G(e,r[t].route)));return i.then((t=>{if(t){if(t.cancel)return this.__previousContext.__renderId=e.__renderId,this.__previousContext;if(t.redirect)return this.__redirect(t.redirect,e.__redirectCount,e.__renderId)}return e}))}__runOnBeforeLeaveCallbacks(e,t,n,r){const i=G(t);return e.then((e=>{if(this.__isLatestRender(t)){return X("onBeforeLeave",[i,n,this],r.element)(e)}})).then((e=>{if(!(e||{}).redirect)return e}))}__runOnBeforeEnterCallbacks(e,t,n,r){const i=G(t,r.route);return e.then((e=>{if(this.__isLatestRender(t)){return X("onBeforeEnter",[i,n,this],r.element)(e)}}))}__isReusableElement(e,t){return!(!e||!t)&&(this.__createdByRouter.get(e)&&this.__createdByRouter.get(t)?e.localName===t.localName:e===t)}__isLatestRender(e){return e.__renderId===this.__lastStartedRenderId}__redirect(e,t,n){if(t>256)throw new Error(o(`Too many redirects when rendering ${e.from}`));return this.resolve({pathname:this.urlForPath(e.pathname,e.params),redirectFrom:e.from,__redirectCount:(t||0)+1,__renderId:n})}__ensureOutlet(e=this.__outlet){if(!(e instanceof Node))throw new TypeError(o(`Expected router outlet to be a valid DOM Node (but got ${e})`))}__updateBrowserHistory({pathname:e,search:t="",hash:n=""},r){if(window.location.pathname!==e||window.location.search!==t||window.location.hash!==n){const i=r?"replaceState":"pushState";window.history[i](null,document.title,e+t+n),window.dispatchEvent(new PopStateEvent("popstate",{state:"vaadin-router-ignore"}))}}__copyUnchangedElements(e,t){let n=this.__outlet;for(let r=0;r<e.__divergedChainIndex;r++){const i=t&&t.chain[r].element;if(i){if(i.parentNode!==n)break;e.chain[r].element=i,n=i}}return n}__addAppearingContent(e,t){this.__ensureOutlet(),this.__removeAppearingContent();const n=this.__copyUnchangedElements(e,t);this.__appearingContent=[],this.__disappearingContent=Array.from(n.children).filter((t=>this.__addedByRouter.get(t)&&t!==e.result));let r=n;for(let t=e.__divergedChainIndex;t<e.chain.length;t++){const i=e.chain[t].element;i&&(r.appendChild(i),this.__addedByRouter.set(i,!0),r===n&&this.__appearingContent.push(i),r=i)}}__removeDisappearingContent(){this.__disappearingContent&&Z(this.__disappearingContent),this.__disappearingContent=null,this.__appearingContent=null}__removeAppearingContent(){this.__disappearingContent&&this.__appearingContent&&(Z(this.__appearingContent),this.__disappearingContent=null,this.__appearingContent=null)}__runOnAfterLeaveCallbacks(e,t){if(t)for(let n=t.chain.length-1;n>=e.__divergedChainIndex&&this.__isLatestRender(e);n--){const r=t.chain[n].element;if(r)try{const n=G(e);J(r.onAfterLeave,[n,{},t.resolver],r)}finally{this.__disappearingContent.indexOf(r)>-1&&Z(r.children)}}}__runOnAfterEnterCallbacks(e){for(let t=e.__divergedChainIndex;t<e.chain.length&&this.__isLatestRender(e);t++){const n=e.chain[t].element||{},r=G(e,e.chain[t].route);J(n.onAfterEnter,[r,{},e.resolver],n)}}__animateIfNeeded(e){const t=(this.__disappearingContent||[])[0],n=(this.__appearingContent||[])[0],r=[],i=e.chain;let o;for(let e=i.length;e>0;e--)if(i[e-1].route.animate){o=i[e-1].route.animate;break}if(t&&n&&o){const e=d(o)&&o.leave||"leaving",i=d(o)&&o.enter||"entering";r.push(Y(t,e)),r.push(Y(n,i))}return Promise.all(r).then((()=>e))}subscribe(){window.addEventListener("vaadin-router-go",this.__navigationEventHandler)}unsubscribe(){window.removeEventListener("vaadin-router-go",this.__navigationEventHandler)}__onNavigationEvent(e){const{pathname:t,search:n,hash:r}=e?e.detail:window.location;p(this.__normalizePathname(t))&&(e&&e.preventDefault&&e.preventDefault(),this.render({pathname:t,search:n,hash:r},!0))}static setTriggers(...e){var t;t=e,V.forEach((e=>e.inactivate())),t.forEach((e=>e.activate())),V=t}urlForName(e,t){return this.__urlForName||(this.__urlForName=H(this)),ee(this.__urlForName(e,t),this)}urlForPath(e,t){return ee(ne.pathToRegexp.compile(e)(t),this)}static go(e){const{pathname:t,search:n,hash:r}=p(e)?this.__createUrl(e,"http://a"):e;return h("go",{pathname:t,search:n,hash:r})}}const re=/\/\*\*\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i,ie=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function oe(e,t){if("function"!=typeof e)return;const n=re.exec(e.toString());if(n)try{e=new Function(n[1])}catch(e){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",e)}return e(t)}window.Vaadin=window.Vaadin||{};const se=function(e,t){if(window.Vaadin.developmentMode)return oe(e,t)};function ae(){}void 0===window.Vaadin.developmentMode&&(window.Vaadin.developmentMode=function(){try{return!!localStorage.getItem("vaadin.developmentmode.force")||["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0&&(ie?!function(){if(ie){if(Object.keys(ie).map((e=>ie[e])).filter((e=>e.productionMode)).length>0)return!0}return!1}():!oe((function(){return!0})))}catch(e){return!1}}());window.Vaadin=window.Vaadin||{},window.Vaadin.registrations=window.Vaadin.registrations||[],window.Vaadin.registrations.push({is:"@vaadin/router",version:"1.7.4"}),se(ae),ne.NavigationTrigger={POPSTATE:b,CLICK:v};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ce=!1,le=!1,ue="${JSCORE_VERSION}",he=function(e,t){if(!e)throw de(t)},de=function(e){return new Error("Firebase Database ("+ue+") INTERNAL ASSERT FAILED: "+e)},fe=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},pe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|s>>4;let h=(15&s)<<2|c>>6,d=63&c;a||(d=64,o||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(fe(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw Error();const c=i<<2|o>>4;if(r.push(c),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},_e=function(e){const t=fe(e);return pe.encodeByteArray(t,!0)},ge=function(e){return _e(e).replace(/\./g,"")},me=function(e){try{return pe.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ve(e){return ye(void 0,e)}function ye(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=ye(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class be{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function we(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ce(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(we())}function Ee(){return!0===ce||!0===le}class Ie extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ie.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Te.prototype.create)}}class Te{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(xe,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new Ie(r,s,n)}}const xe=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ke(e){return JSON.parse(e)}function Se(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=ke(me(o[0])||""),n=ke(me(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},Re=function(e){const t=Ne(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},Pe=function(e){const t=Ne(e).claims;return"object"==typeof t&&!0===t.admin};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ae(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Oe(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function De(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Le(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Me(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(Fe(n)&&Fe(o)){if(!Me(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function Fe(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function je(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class qe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^s&(a^c),i=1518500249):(r=s^a^c,i=1859775393):e<60?(r=s&a|c&(s|a),i=2400959708):(r=s^a^c,i=3395469782);const t=(o<<5|o>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function Ue(e,t){return`${e} failed: ${t} argument `}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Be=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,he(r<e.length,"Surrogate pair missing trail surrogate.");i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},We=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function $e(e){return e&&e._delegate?e._delegate:e}class ze{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class He{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new be;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,"[DEFAULT]"===r?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:"[DEFAULT]":e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ve{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new He(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ye=[];var Ke,Ge;(Ge=Ke||(Ke={}))[Ge.DEBUG=0]="DEBUG",Ge[Ge.VERBOSE=1]="VERBOSE",Ge[Ge.INFO=2]="INFO",Ge[Ge.WARN=3]="WARN",Ge[Ge.ERROR=4]="ERROR",Ge[Ge.SILENT=5]="SILENT";const Qe={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},Je=Ke.INFO,Xe={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},Ze=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=Xe[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class et{constructor(e){this.name=e,this._logLevel=Je,this._logHandler=Ze,this._userLogHandler=null,Ye.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Qe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}let tt,nt;const rt=new WeakMap,it=new WeakMap,ot=new WeakMap,st=new WeakMap,at=new WeakMap;let ct={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return it.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ot.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ht(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function lt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(nt||(nt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(dt(this),t),ht(rt.get(this))}:function(...t){return ht(e.apply(dt(this),t))}:function(t,...n){const r=e.call(dt(this),t,...n);return ot.set(r,t.sort?t.sort():[t]),ht(r)}}function ut(e){return"function"==typeof e?lt(e):(e instanceof IDBTransaction&&function(e){if(it.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));it.set(e,t)}(e),t=e,(tt||(tt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,ct):e);var t}function ht(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(ht(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&rt.set(t,e)})).catch((()=>{})),at.set(t,e),t}(e);if(st.has(e))return st.get(e);const t=ut(e);return t!==e&&(st.set(e,t),at.set(t,e)),t}const dt=e=>at.get(e);function ft(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=ht(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(ht(s.result),e.oldVersion,e.newVersion,ht(s.transaction))})),n&&s.addEventListener("blocked",(()=>n())),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}const pt=["get","getKey","getAll","getAllKeys","count"],_t=["put","add","delete","clear"],gt=new Map;function mt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(gt.get(t))return gt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=_t.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!pt.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return gt.set(t,o),o}ct=(e=>({...e,get:(t,n,r)=>mt(t,n)||e.get(t,n,r),has:(t,n)=>!!mt(t,n)||e.has(t,n)}))(ct);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class vt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const yt=new et("@firebase/app"),bt={"@firebase/app":"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},wt=new Map,Ct=new Map;function Et(e,t){try{e.container.addComponent(t)}catch(n){yt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function It(e){const t=e.name;if(Ct.has(t))return yt.debug(`There were multiple attempts to register component ${t}.`),!1;Ct.set(t,e);for(const t of wt.values())Et(t,e);return!0}function Tt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const xt=new Te("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class kt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ze("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xt.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(e="[DEFAULT]"){const t=wt.get(e);if(!t)throw xt.create("no-app",{appName:e});return t}function Nt(e,t,n){var r;let i=null!==(r=bt[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void yt.warn(e.join(" "))}It(new ze(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}let Rt=null;function Pt(){return Rt||(Rt=ft("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore("firebase-heartbeat-store")}}).catch((e=>{throw xt.create("idb-open",{originalErrorMessage:e.message})}))),Rt}async function At(e,t){var n;try{const n=(await Pt()).transaction("firebase-heartbeat-store","readwrite"),r=n.objectStore("firebase-heartbeat-store");return await r.put(t,Ot(e)),n.done}catch(e){if(e instanceof Ie)yt.warn(e.message);else{const t=xt.create("idb-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message});yt.warn(t.message)}}}function Ot(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Mt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Lt();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Lt(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Ft(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ft(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=ge(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Lt(){return(new Date).toISOString().substring(0,10)}class Mt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return"object"==typeof indexedDB&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){var t;try{return(await Pt()).transaction("firebase-heartbeat-store").objectStore("firebase-heartbeat-store").get(Ot(e))}catch(e){if(e instanceof Ie)yt.warn(e.message);else{const n=xt.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});yt.warn(n.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return At(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return At(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ft(e){return ge(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt;jt="",It(new ze("platform-logger",(e=>new vt(e)),"PRIVATE")),It(new ze("heartbeat",(e=>new Dt(e)),"PRIVATE")),Nt("@firebase/app","0.7.32",jt),Nt("@firebase/app","0.7.32","esm2017"),Nt("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Nt("firebase","9.9.4","app");var qt=r("hPtJY");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ut="";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Bt{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Se(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:ke(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ae(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Bt(t)}}catch(e){}return new Wt},zt=$t("localStorage"),Ht=$t("sessionStorage"),Vt=new et("@firebase/database"),Yt=function(){let e=1;return function(){return e++}}(),Kt=function(e){const t=Be(e),n=new qe;n.update(t);const r=n.digest();return pe.encodeByteArray(r)},Gt=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=Gt.apply(null,r):t+="object"==typeof r?Se(r):r,t+=" "}return t};let Qt=null,Jt=!0;const Xt=function(e,t){he(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Vt.logLevel=Ke.VERBOSE,Qt=Vt.log.bind(Vt),t&&Ht.set("logging_enabled",!0)):"function"==typeof e?Qt=e:(Qt=null,Ht.remove("logging_enabled"))},Zt=function(...e){if(!0===Jt&&(Jt=!1,null===Qt&&!0===Ht.get("logging_enabled")&&Xt(!0)),Qt){const t=Gt.apply(null,e);Qt(t)}},en=function(e){return function(...t){Zt(e,...t)}},tn=function(...e){const t="FIREBASE INTERNAL ERROR: "+Gt(...e);Vt.error(t)},nn=function(...e){const t=`FIREBASE FATAL ERROR: ${Gt(...e)}`;throw Vt.error(t),new Error(t)},rn=function(...e){const t="FIREBASE WARNING: "+Gt(...e);Vt.warn(t)},on=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},sn=function(e,t){if(e===t)return 0;if("[MIN_NAME]"===e||"[MAX_NAME]"===t)return-1;if("[MIN_NAME]"===t||"[MAX_NAME]"===e)return 1;{const n=pn(e),r=pn(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},an=function(e,t){return e===t?0:e<t?-1:1},cn=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Se(t))},ln=function(e){if("object"!=typeof e||null===e)return Se(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=Se(t[r]),n+=":",n+=ln(e[t[r]]);return n+="}",n},un=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function hn(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const dn=function(e){he(!on(e),"Invalid JSON number");const t=1023;let n,r,i,o,s;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=o+t,i=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(s=52;s;s-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(s=11;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let l="";for(s=0;s<64;s+=8){let e=parseInt(c.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()};const fn=new RegExp("^-?(0*)\\d{1,10}$"),pn=function(e){if(fn.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},_n=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw rn("Exception was thrown by user callback.",t),e}),Math.floor(0))}},gn=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class mn{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){rn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Zt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',rn(e)}}class yn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yn.OWNER="owner";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const bn=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class wn{constructor(e,t,n,r,i=!1,o="",s=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=zt.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&zt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Cn(e,t,n){let r;if(he("string"==typeof t,"typeof type must == string"),he("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return hn(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(){this.counters_={}}incrementCounter(e,t=1){Ae(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ve(this.counters_)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In={},Tn={};function xn(e){const t=e.toString();return In[t]||(In[t]=new En),In[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class kn{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&_n((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,t,n,r,i,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=en(e),this.stats_=xn(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),Cn(t,"long_polling",e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new kn(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Ee()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Nn(((...e)=>{const[t,n,r,i,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===t)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&bn.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Sn.forceAllow_=!0}static forceDisallow(){Sn.forceDisallow_=!0}static isAvailable(){return!Ee()&&(!!Sn.forceAllow_||!(Sn.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Se(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=_e(t),r=un(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Ee())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Se(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Nn{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Ee())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Yt(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Nn.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Zt("frame writing exception"),e.stack&&Zt(e.stack),Zt(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Zt("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){Ee()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Zt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rn=null;"undefined"!=typeof MozWebSocket?Rn=MozWebSocket:"undefined"!=typeof WebSocket&&(Rn=WebSocket);class Pn{constructor(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=en(this.connId),this.stats_=xn(t),this.connURL=Pn.connectionURL_(t,o,s,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const o={v:"5"};return!Ee()&&"undefined"!=typeof location&&location.hostname&&bn.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o.ac=r),i&&(o.p=i),Cn(e,"websocket",o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,zt.set("previous_websocket_failure",!0);try{let e;if(Ee()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":`Firebase/5/${Ut}/${qt.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new Rn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Pn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Rn&&!Pn.forceDisallow_}static previouslyFailed(){return zt.isInMemoryStorage||!0===zt.get("previous_websocket_failure")}markConnectionHealthy(){zt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=ke(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(he(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Se(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=un(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pn.responsesRequiredToBeHealthy=2,Pn.healthyTimeout=3e4;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class An{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Sn,Pn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Pn&&Pn.isAvailable();let n=t&&!Pn.previouslyFailed();if(e.webSocketOnly&&(t||rn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Pn];else{const e=this.transports_=[];for(const t of An.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);An.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}An.globalTransportInitialized_=!1;class On{constructor(e,t,n,r,i,o,s,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=en("c:"+this.id+":"),this.transportManager_=new An(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=gn((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=cn("t",e),n=cn("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=cn("t",e),n=cn("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=cn("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?tn("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):tn("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&rn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),gn((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):gn((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(zt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.allowedEvents_=e,this.listeners_={},he(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){he(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends Ln{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Ce()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Mn}getInitialEvent(e){return he("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function jn(){return new Fn("")}function qn(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Un(e){return e.pieces_.length-e.pieceNum_}function Bn(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Fn(e.pieces_,t)}function Wn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function $n(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function zn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Fn(t,0)}function Hn(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof Fn)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Fn(n,0)}function Vn(e){return e.pieceNum_>=e.pieces_.length}function Yn(e,t){const n=qn(e),r=qn(t);if(null===n)return t;if(n===r)return Yn(Bn(e),Bn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Kn(e,t){if(Un(e)!==Un(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Gn(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Un(e)>Un(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Qn{constructor(e,t){this.errorPrefix_=t,this.parts_=$n(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=We(this.parts_[e]);Jn(this)}}function Jn(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Xn(e))}function Xn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn extends Ln{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Zn}getInitialEvent(e){return he("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends Dn{constructor(e,t,n,r,i,o,s,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=er.nextPersistentConnectionId_++,this.log_=en("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=1e3,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Ee())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Zn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Mn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Se(i)),he(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new be,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),he(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;er.warnOnListenWarnings_(o,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&Ae(e,"w")){const n=Oe(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();rn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||Pe(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Re(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Se(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):tn("Unrecognized action received from server: "+Se(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){he(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+er.nextConnectionId_++,i=this.lastSessionId;let o=!1,s=null;const a=function(){s?s.close():(o=!0,n())},c=function(e){he(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);o?Zt("getToken() completed but was canceled"):(Zt("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,s=new On(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{rn(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&rn(e),a())}}}interrupt(e){Zt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Zt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],De(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>ln(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Fn(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Zt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Zt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";Ee()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Ut.replace(/\./g,"-")]=1,Ce()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Mn.getInstance().currentlyOnline();return De(this.interruptReasons_)&&e}}er.nextPersistentConnectionId_=0,er.nextConnectionId_=0;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class tr{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new tr(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new tr("[MIN_NAME]",e),r=new tr("[MIN_NAME]",t);return 0!==this.compare(n,r)}minPost(){return tr.MIN}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rr;class ir extends nr{static get __EMPTY_NODE(){return rr}static set __EMPTY_NODE(e){rr=e}compare(e,t){return sn(e.name,t.name)}isDefinedOn(e){throw de("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return tr.MIN}maxPost(){return new tr("[MAX_NAME]",rr)}makePost(e,t){return he("string"==typeof e,"KeyIndex indexValue must always be a string."),new tr(e,rr)}toString(){return".key"}}const or=new ir;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ar{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ar.RED,this.left=null!=r?r:cr.EMPTY_NODE,this.right=null!=i?i:cr.EMPTY_NODE}copy(e,t,n,r,i){return new ar(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return cr.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return cr.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ar.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ar.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ar.RED=!0,ar.BLACK=!1;class cr{constructor(e,t=cr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new cr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ar.BLACK,null,null))}remove(e){return new cr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ar.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new sr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new sr(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new sr(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new sr(this.root_,null,this.comparator_,!0,e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function lr(e,t){return sn(e.name,t.name)}function ur(e,t){return sn(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hr;cr.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new ar(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const dr=function(e){return"number"==typeof e?"number:"+dn(e):"string:"+e},fr=function(e){if(e.isLeafNode()){const t=e.val();he("string"==typeof t||"number"==typeof t||"object"==typeof t&&Ae(t,".sv"),"Priority must be a string or number.")}else he(e===hr||e.isEmpty(),"priority of unexpected type.");he(e===hr||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let pr,_r,gr;class mr{constructor(e,t=mr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,he(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),fr(this.priorityNode_)}static set __childrenNodeConstructor(e){pr=e}static get __childrenNodeConstructor(){return pr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new mr(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:mr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Vn(e)?this:".priority"===qn(e)?this.priorityNode_:mr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:mr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=qn(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(he(".priority"!==n||1===Un(e),".priority must be the last token in a path"),this.updateImmediateChild(n,mr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Bn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+dr(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?dn(this.value_):this.value_,this.lazyHash_=Kt(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===mr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof mr.__childrenNodeConstructor?-1:(he(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=mr.VALUE_TYPE_ORDER.indexOf(t),i=mr.VALUE_TYPE_ORDER.indexOf(n);return he(r>=0,"Unknown leaf type: "+t),he(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}mr.VALUE_TYPE_ORDER=["object","boolean","number","string"];const vr=new class extends nr{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?sn(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return tr.MIN}maxPost(){return new tr("[MAX_NAME]",new mr("[PRIORITY-POST]",gr))}makePost(e,t){const n=_r(e);return new tr(t,new mr("[PRIORITY-POST]",n))}toString(){return".priority"}},yr=Math.log(2);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/yr,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const wr=function(e,t,n,r){e.sort(t);const i=function(t,r){const o=r-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new ar(a,s.node,ar.BLACK,null,null);{const c=parseInt(o/2,10)+t,l=i(t,c),u=i(c+1,r);return s=e[c],a=n?n(s):s,new ar(a,s.node,ar.BLACK,l,u)}},o=function(t){let r=null,o=null,s=e.length;const a=function(t,r){const o=s-t,a=s;s-=t;const l=i(o+1,a),u=e[o],h=n?n(u):u;c(new ar(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(o=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,ar.BLACK):(a(r,ar.BLACK),a(r,ar.RED))}return o}(new br(e.length));return new cr(r||t,o)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cr;const Er={};class Ir{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return he(Er&&vr,"ChildrenNode.ts has not been loaded"),Cr=Cr||new Ir({".priority":Er},{".priority":vr}),Cr}get(e){const t=Oe(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof cr?t:null}hasIndex(e){return Ae(this.indexSet_,e.toString())}addIndex(e,t){he(e!==or,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(tr.Wrap);let o,s=i.getNext();for(;s;)r=r||e.isDefinedOn(s.node),n.push(s),s=i.getNext();o=r?wr(n,e.getCompare()):Er;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const l=Object.assign({},this.indexes_);return l[a]=o,new Ir(l,c)}addToIndexes(e,t){const n=Le(this.indexes_,((n,r)=>{const i=Oe(this.indexSet_,r);if(he(i,"Missing index implementation for "+r),n===Er){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(tr.Wrap);let o=r.getNext();for(;o;)o.name!==e.name&&n.push(o),o=r.getNext();return n.push(e),wr(n,i.getCompare())}return Er}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new tr(e.name,r))),i.insert(e,e.node)}}));return new Ir(n,this.indexSet_)}removeFromIndexes(e,t){const n=Le(this.indexes_,(n=>{if(n===Er)return n;{const r=t.get(e.name);return r?n.remove(new tr(e.name,r)):n}}));return new Ir(n,this.indexSet_)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr;class xr{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&fr(this.priorityNode_),this.children_.isEmpty()&&he(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Tr||(Tr=new xr(new cr(ur),null,Ir.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Tr}updatePriority(e){return this.children_.isEmpty()?this:new xr(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Tr:t}}getChild(e){const t=qn(e);return null===t?this:this.getImmediateChild(t).getChild(Bn(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(he(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new tr(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?Tr:this.priorityNode_;return new xr(r,o,i)}}updateChild(e,t){const n=qn(e);if(null===n)return t;{he(".priority"!==qn(e)||1===Un(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Bn(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(vr,((o,s)=>{t[o]=s.val(e),n++,i&&xr.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+dr(this.getPriority().val())+":"),this.forEachChild(vr,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Kt(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new tr(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new tr(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new tr(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,tr.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,tr.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===kr?-1:0}withIndex(e){if(e===or||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new xr(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===or||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(vr),n=t.getIterator(vr);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===or?null:this.indexMap_.get(e.toString())}}xr.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const kr=new class extends xr{constructor(){super(new cr(ur),xr.EMPTY_NODE,Ir.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return xr.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(tr,{MIN:{value:new tr("[MIN_NAME]",xr.EMPTY_NODE)},MAX:{value:new tr("[MAX_NAME]",kr)}}),ir.__EMPTY_NODE=xr.EMPTY_NODE,mr.__childrenNodeConstructor=xr,hr=kr,function(e){gr=e}(kr);function Sr(e,t=null){if(null===e)return xr.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),he(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new mr(e,Sr(t))}if(e instanceof Array){let n=xr.EMPTY_NODE;return hn(e,((t,r)=>{if(Ae(e,t)&&"."!==t.substring(0,1)){const e=Sr(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Sr(t))}{const n=[];let r=!1;if(hn(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Sr(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new tr(e,i)))}})),0===n.length)return xr.EMPTY_NODE;const i=wr(n,lr,(e=>e.name),ur);if(r){const e=wr(n,vr.getCompare());return new xr(i,Sr(t),new Ir({".priority":e},{".priority":vr}))}return new xr(i,Sr(t),Ir.Default)}}!function(e){_r=e}(Sr);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Nr extends nr{constructor(e){super(),this.indexPath_=e,he(!Vn(e)&&".priority"!==qn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?sn(e.name,t.name):i}makePost(e,t){const n=Sr(e),r=xr.EMPTY_NODE.updateChild(this.indexPath_,n);return new tr(t,r)}maxPost(){const e=xr.EMPTY_NODE.updateChild(this.indexPath_,kr);return new tr("[MAX_NAME]",e)}toString(){return $n(this.indexPath_,0).join("/")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=new class extends nr{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?sn(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return tr.MIN}maxPost(){return tr.MAX}makePost(e,t){const n=Sr(e);return new tr(t,n)}toString(){return".value"}},Pr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(){let e=0;const t=[]}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ar(e){return{type:"value",snapshotNode:e}}function Or(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Dr(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Lr(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Mr{constructor(e){this.index_=e}updateChild(e,t,n,r,i,o){he(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Dr(t,s)):he(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(Or(t,n)):o.trackChildChange(Lr(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(vr,((e,r)=>{t.hasChild(e)||n.trackChildChange(Dr(e,r))})),t.isLeafNode()||t.forEachChild(vr,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Lr(t,r,i))}else n.trackChildChange(Or(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?xr.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.indexedFilter_=new Mr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fr.getStartPost_(e),this.endPost_=Fr.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,o){return this.matches(new tr(t,n))||(n=xr.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=xr.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(xr.EMPTY_NODE);const i=this;return t.forEachChild(vr,((e,t)=>{i.matches(new tr(e,t))||(r=r.updateImmediateChild(e,xr.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.rangedFilter_=new Fr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,o){return this.rangedFilter_.matches(new tr(t,n))||(n=xr.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=xr.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=xr.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,o;if(r=t.withIndex(this.index_),r=r.updatePriority(xr.EMPTY_NODE),this.reverse_){o=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else o=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let s=0,a=!1;for(;o.hasNext();){const t=o.getNext();!a&&i(e,t)<=0&&(a=!0);a&&s<this.limit_&&i(t,n)<=0?s++:r=r.updateImmediateChild(t.name,xr.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const s=e;he(s.numChildren()===this.limit_,"");const a=new tr(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(a);if(s.hasChild(t)){const e=s.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=u&&(u.name===t||s.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:o(u,a);if(l&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Lr(t,n,e)),s.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(Dr(t,e));const n=s.updateImmediateChild(t,xr.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(Or(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:l&&o(c,a)>=0?(null!=i&&(i.trackChildChange(Dr(c.name,c.node)),i.trackChildChange(Or(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,xr.EMPTY_NODE)):e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=vr}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return he(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return he(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:"[MIN_NAME]"}hasEnd(){return this.endSet_}getIndexEndValue(){return he(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return he(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:"[MAX_NAME]"}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return he(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===vr}copy(){const e=new qr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ur(e){const t={};if(e.isDefault())return t;let n;return e.index_===vr?n="$priority":e.index_===Rr?n="$value":e.index_===or?n="$key":(he(e.index_ instanceof Nr,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Se(n),e.startSet_&&(t.startAt=Se(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+Se(e.indexStartName_))),e.endSet_&&(t.endAt=Se(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+Se(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Br(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==vr&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Dn{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=en("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(he(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Wr.getListenId_(e,n),s={};this.listens_[o]=s;const a=Ur(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),Oe(this.listens_,o)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Wr.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Ur(e._queryParams),n=e._path.toString(),r=new be;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+je(t);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let e=null;if(s.status>=200&&s.status<300){try{e=ke(s.responseText)}catch(e){rn("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&rn("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(){this.rootNode_=xr.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(){return{value:null,children:new Map}}function Hr(e,t,n){if(Vn(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=qn(t);e.children.has(r)||e.children.set(r,zr());Hr(e.children.get(r),t=Bn(t),n)}}function Vr(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,((e,r)=>{Vr(r,new Fn(t.toString()+"/"+e),n)}))}class Yr{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&hn(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Yr(e);const n=1e4+2e4*Math.random();gn(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;hn(e,((e,r)=>{r>0&&Ae(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),gn(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gr,Qr;function Jr(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Qr=Gr||(Gr={}))[Qr.OVERWRITE=0]="OVERWRITE",Qr[Qr.MERGE=1]="MERGE",Qr[Qr.ACK_USER_WRITE=2]="ACK_USER_WRITE",Qr[Qr.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Xr{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Gr.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Vn(this.path)){if(null!=this.affectedTree.value)return he(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Fn(e));return new Xr(jn(),t,this.revert)}}return he(qn(this.path)===e,"operationForChild called for unrelated child."),new Xr(Bn(this.path),this.affectedTree,this.revert)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){this.source=e,this.path=t,this.type=Gr.LISTEN_COMPLETE}operationForChild(e){return Vn(this.path)?new Zr(this.source,jn()):new Zr(this.source,Bn(this.path))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Gr.OVERWRITE}operationForChild(e){return Vn(this.path)?new ei(this.source,jn(),this.snap.getImmediateChild(e)):new ei(this.source,Bn(this.path),this.snap)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Gr.MERGE}operationForChild(e){if(Vn(this.path)){const t=this.children.subtree(new Fn(e));return t.isEmpty()?null:t.value?new ei(this.source,jn(),t.value):new ti(this.source,jn(),t)}return he(qn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ti(this.source,Bn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Vn(e))return this.isFullyInitialized()&&!this.filtered_;const t=qn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ii(e,t,n,r,i,o){const s=r.filter((e=>e.type===n));s.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw de("Should only compare child_ events.");const r=new tr(t.childName,t.snapshotNode),i=new tr(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n))),s.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function oi(e,t){return{eventCache:e,serverCache:t}}function si(e,t,n,r){return oi(new ni(t,n,r),e.serverCache)}function ai(e,t,n,r){return oi(e.eventCache,new ni(t,n,r))}function ci(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function li(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ui;class hi{constructor(e,t=(()=>(ui||(ui=new cr(an)),ui))()){this.value=e,this.children=t}static fromObject(e){let t=new hi(null);return hn(e,((e,n)=>{t=t.set(new Fn(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:jn(),value:this.value};if(Vn(e))return null;{const n=qn(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Bn(e),t);if(null!=i){return{path:Hn(new Fn(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Vn(e))return this;{const t=qn(e),n=this.children.get(t);return null!==n?n.subtree(Bn(e)):new hi(null)}}set(e,t){if(Vn(e))return new hi(t,this.children);{const n=qn(e),r=(this.children.get(n)||new hi(null)).set(Bn(e),t),i=this.children.insert(n,r);return new hi(this.value,i)}}remove(e){if(Vn(e))return this.children.isEmpty()?new hi(null):new hi(null,this.children);{const t=qn(e),n=this.children.get(t);if(n){const r=n.remove(Bn(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new hi(null):new hi(this.value,i)}return this}}get(e){if(Vn(e))return this.value;{const t=qn(e),n=this.children.get(t);return n?n.get(Bn(e)):null}}setTree(e,t){if(Vn(e))return t;{const n=qn(e),r=(this.children.get(n)||new hi(null)).setTree(Bn(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new hi(this.value,i)}}fold(e){return this.fold_(jn(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Hn(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,jn(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Vn(e))return null;{const r=qn(e),i=this.children.get(r);return i?i.findOnPath_(Bn(e),Hn(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,jn(),t)}foreachOnPath_(e,t,n){if(Vn(e))return this;{this.value&&n(t,this.value);const r=qn(e),i=this.children.get(r);return i?i.foreachOnPath_(Bn(e),Hn(t,r),n):new hi(null)}}foreach(e){this.foreach_(jn(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Hn(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.writeTree_=e}static empty(){return new di(new hi(null))}}function fi(e,t,n){if(Vn(t))return new di(new hi(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const s=Yn(i,t);return o=o.updateChild(s,n),new di(e.writeTree_.set(i,o))}{const r=new hi(n),i=e.writeTree_.setTree(t,r);return new di(i)}}}function pi(e,t,n){let r=e;return hn(n,((e,n)=>{r=fi(r,Hn(t,e),n)})),r}function _i(e,t){if(Vn(t))return di.empty();{const n=e.writeTree_.setTree(t,new hi(null));return new di(n)}}function gi(e,t){return null!=mi(e,t)}function mi(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Yn(n.path,t)):null}function vi(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(vr,((e,n)=>{t.push(new tr(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new tr(e,n.value))})),t}function yi(e,t){if(Vn(t))return e;{const n=mi(e,t);return new di(null!=n?new hi(n):e.writeTree_.subtree(t))}}function bi(e){return e.writeTree_.isEmpty()}function wi(e,t){return Ci(jn(),e.writeTree_,t)}function Ci(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(he(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ci(Hn(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Hn(e,".priority"),r)),n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(e,t){return Mi(t,e)}function Ii(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));he(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,s=e.allWrites.length-1;for(;i&&s>=0;){const t=e.allWrites[s];t.visible&&(s>=n&&Ti(t,r.path)?i=!1:Gn(r.path,t.path)&&(o=!0)),s--}if(i){if(o)return function(e){e.visibleWrites=ki(e.allWrites,xi,jn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=_i(e.visibleWrites,r.path);else{hn(r.children,(t=>{e.visibleWrites=_i(e.visibleWrites,Hn(r.path,t))}))}return!0}return!1}function Ti(e,t){if(e.snap)return Gn(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Gn(Hn(e.path,n),t))return!0;return!1}function xi(e){return e.visible}function ki(e,t,n){let r=di.empty();for(let i=0;i<e.length;++i){const o=e[i];if(t(o)){const e=o.path;let t;if(o.snap)Gn(n,e)?(t=Yn(n,e),r=fi(r,t,o.snap)):Gn(e,n)&&(t=Yn(e,n),r=fi(r,jn(),o.snap.getChild(t)));else{if(!o.children)throw de("WriteRecord should have .snap or .children");if(Gn(n,e))t=Yn(n,e),r=pi(r,t,o.children);else if(Gn(e,n))if(t=Yn(e,n),Vn(t))r=pi(r,jn(),o.children);else{const e=Oe(o.children,qn(t));if(e){const n=e.getChild(Bn(t));r=fi(r,jn(),n)}}}}}return r}function Si(e,t,n,r,i){if(r||i){const o=yi(e.visibleWrites,t);if(!i&&bi(o))return n;if(i||null!=n||gi(o,jn())){const o=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Gn(e.path,t)||Gn(t,e.path))};return wi(ki(e.allWrites,o,t),n||xr.EMPTY_NODE)}return null}{const r=mi(e.visibleWrites,t);if(null!=r)return r;{const r=yi(e.visibleWrites,t);if(bi(r))return n;if(null!=n||gi(r,jn())){return wi(r,n||xr.EMPTY_NODE)}return null}}}function Ni(e,t,n,r){return Si(e.writeTree,e.treePath,t,n,r)}function Ri(e,t){return function(e,t,n){let r=xr.EMPTY_NODE;const i=mi(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(vr,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=yi(e.visibleWrites,t);return n.forEachChild(vr,((e,t)=>{const n=wi(yi(i,new Fn(e)),t);r=r.updateImmediateChild(e,n)})),vi(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return vi(yi(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Pi(e,t,n,r){return function(e,t,n,r,i){he(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Hn(t,n);if(gi(e.visibleWrites,o))return null;{const t=yi(e.visibleWrites,o);return bi(t)?i.getChild(n):wi(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Ai(e,t){return function(e,t){return mi(e.visibleWrites,t)}(e.writeTree,Hn(e.treePath,t))}function Oi(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){let a;const c=yi(e.visibleWrites,t),l=mi(c,jn());if(null!=l)a=l;else{if(null==n)return[];a=wi(c,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,o)}function Di(e,t,n){return function(e,t,n,r){const i=Hn(t,n),o=mi(e.visibleWrites,i);if(null!=o)return o;if(r.isCompleteForChild(n))return wi(yi(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Li(e,t){return Mi(Hn(e.treePath,t),e.writeTree)}function Mi(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;he("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),he(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Lr(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Dr(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Or(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw de("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Lr(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class qi{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new ni(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Di(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:li(this.viewCache_),i=Oi(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(e,t,n,r,i){const o=new Fi;let s,a;if(n.type===Gr.OVERWRITE){const c=n;c.source.fromUser?s=$i(e,t,c.path,c.snap,r,i,o):(he(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Vn(c.path),s=Wi(e,t,c.path,c.snap,r,i,a,o))}else if(n.type===Gr.MERGE){const c=n;c.source.fromUser?s=function(e,t,n,r,i,o,s){let a=t;return r.foreach(((r,c)=>{const l=Hn(n,r);zi(t,qn(l))&&(a=$i(e,a,l,c,i,o,s))})),r.foreach(((r,c)=>{const l=Hn(n,r);zi(t,qn(l))||(a=$i(e,a,l,c,i,o,s))})),a}(e,t,c.path,c.children,r,i,o):(he(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),s=Vi(e,t,c.path,c.children,r,i,a,o))}else if(n.type===Gr.ACK_USER_WRITE){const a=n;s=a.revert?function(e,t,n,r,i,o){let s;if(null!=Ai(r,n))return t;{const a=new qi(r,t,i),c=t.eventCache.getNode();let l;if(Vn(n)||".priority"===qn(n)){let n;if(t.serverCache.isFullyInitialized())n=Ni(r,li(t));else{const e=t.serverCache.getNode();he(e instanceof xr,"serverChildren would be complete if leaf node"),n=Ri(r,e)}l=e.filter.updateFullNode(c,n,o)}else{const i=qn(n);let u=Di(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=c.getImmediateChild(i)),l=null!=u?e.filter.updateChild(c,i,u,Bn(n),a,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,xr.EMPTY_NODE,Bn(n),a,o):c,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(s=Ni(r,li(t)),s.isLeafNode()&&(l=e.filter.updateFullNode(l,s,o)))}return s=t.serverCache.isFullyInitialized()||null!=Ai(r,jn()),si(t,l,s,e.filter.filtersNodes())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,a.path,r,i,o):function(e,t,n,r,i,o,s){if(null!=Ai(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Vn(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Wi(e,t,n,c.getNode().getChild(n),i,o,a,s);if(Vn(n)){let r=new hi(null);return c.getNode().forEachChild(or,((e,t)=>{r=r.set(new Fn(e),t)})),Vi(e,t,n,r,i,o,a,s)}return t}{let l=new hi(null);return r.foreach(((e,t)=>{const r=Hn(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),Vi(e,t,n,l,i,o,a,s)}}(e,t,a.path,a.affectedTree,r,i,o)}else{if(n.type!==Gr.LISTEN_COMPLETE)throw de("Unknown operation type: "+n.type);s=function(e,t,n,r,i){const o=t.serverCache,s=ai(t,o.getNode(),o.isFullyInitialized()||Vn(n),o.isFiltered());return Bi(e,s,n,r,ji,i)}(e,t,n.path,r,o)}const c=o.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ci(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ar(ci(t)))}}(t,s,c),{viewCache:s,changes:c}}function Bi(e,t,n,r,i,o){const s=t.eventCache;if(null!=Ai(r,n))return t;{let a,c;if(Vn(n))if(he(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=li(t),i=Ri(r,n instanceof xr?n:xr.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=Ni(r,li(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const l=qn(n);if(".priority"===l){he(1===Un(n),"Can't have a priority with additional path components");const i=s.getNode();c=t.serverCache.getNode();const o=Pi(r,n,i,c);a=null!=o?e.filter.updatePriority(i,o):s.getNode()}else{const u=Bn(n);let h;if(s.isCompleteForChild(l)){c=t.serverCache.getNode();const e=Pi(r,n,s.getNode(),c);h=null!=e?s.getNode().getImmediateChild(l).updateChild(u,e):s.getNode().getImmediateChild(l)}else h=Di(r,l,t.serverCache);a=null!=h?e.filter.updateChild(s.getNode(),l,h,u,i,o):s.getNode()}}return si(t,a,s.isFullyInitialized()||Vn(n),e.filter.filtersNodes())}}function Wi(e,t,n,r,i,o,s,a){const c=t.serverCache;let l;const u=s?e.filter:e.filter.getIndexedFilter();if(Vn(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=qn(n);if(!c.isCompleteForPath(n)&&Un(n)>1)return t;const i=Bn(n),o=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),o):u.updateChild(c.getNode(),e,o,i,ji,null)}const h=ai(t,l,c.isFullyInitialized()||Vn(n),u.filtersNodes());return Bi(e,h,n,i,new qi(i,h,o),a)}function $i(e,t,n,r,i,o,s){const a=t.eventCache;let c,l;const u=new qi(i,t,o);if(Vn(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,s),c=si(t,l,!0,e.filter.filtersNodes());else{const i=qn(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=si(t,l,a.isFullyInitialized(),a.isFiltered());else{const o=Bn(n),l=a.getNode().getImmediateChild(i);let h;if(Vn(o))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Wn(o)&&e.getChild(zn(o)).isEmpty()?e:e.updateChild(o,r):xr.EMPTY_NODE}if(l.equals(h))c=t;else{c=si(t,e.filter.updateChild(a.getNode(),i,h,o,u,s),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function zi(e,t){return e.eventCache.isCompleteForChild(t)}function Hi(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Vi(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=Vn(n)?r:new hi(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=Hi(0,t.serverCache.getNode().getImmediateChild(n),r);l=Wi(e,l,new Fn(n),c,i,o,s,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!c){const c=Hi(0,t.serverCache.getNode().getImmediateChild(n),r);l=Wi(e,l,new Fn(n),c,i,o,s,a)}})),l}class Yi{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Mr(n.getIndex()),i=(o=n).loadsAllData()?new Mr(o.getIndex()):o.hasLimit()?new jr(o):new Fr(o);var o;this.processor_=function(e){return{filter:e}}(i);const s=t.serverCache,a=t.eventCache,c=r.updateFullNode(xr.EMPTY_NODE,s.getNode(),null),l=i.updateFullNode(xr.EMPTY_NODE,a.getNode(),null),u=new ni(c,s.isFullyInitialized(),r.filtersNodes()),h=new ni(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=oi(h,u),this.eventGenerator_=new ri(this.query_)}get query(){return this.query_}}function Ki(e,t){const n=li(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Vn(t)&&!n.getImmediateChild(qn(t)).isEmpty())?n.getChild(t):null}function Gi(e){return 0===e.eventRegistrations_.length}function Qi(e,t,n){const r=[];if(n){he(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Ji(e,t,n,r){t.type===Gr.MERGE&&null!==t.source.queryId&&(he(li(e.viewCache_),"We should always have a full cache before handling merges"),he(ci(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,o=Ui(e.processor_,i,t,n,r);var s,a;return s=e.processor_,a=o.viewCache,he(a.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),he(a.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed"),he(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,Xi(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Xi(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),ii(e,i,"child_removed",t,r,n),ii(e,i,"child_added",t,r,n),ii(e,i,"child_moved",o,r,n),ii(e,i,"child_changed",t,r,n),ii(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi,eo;class to{constructor(){this.views=new Map}}function no(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return he(null!=o,"SyncTree gave us an op for an invalid query."),Ji(o,t,n,r)}{let i=[];for(const o of e.views.values())i=i.concat(Ji(o,t,n,r));return i}}function ro(e,t,n,r,i){const o=t._queryIdentifier,s=e.views.get(o);if(!s){let e=Ni(n,i?r:null),o=!1;e?o=!0:r instanceof xr?(e=Ri(n,r),o=!1):(e=xr.EMPTY_NODE,o=!1);const s=oi(new ni(e,o,!1),new ni(r,i,!1));return new Yi(t,s)}return s}function io(e,t,n,r,i,o){const s=ro(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,s),function(e,t){e.eventRegistrations_.push(t)}(s,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(vr,((e,t)=>{r.push(Or(e,t))}));return n.isFullyInitialized()&&r.push(Ar(n.getNode())),Xi(e,r,n.getNode(),t)}(s,n)}function oo(e,t,n,r){const i=t._queryIdentifier,o=[];let s=[];const a=uo(e);if("default"===i)for(const[t,i]of e.views.entries())s=s.concat(Qi(i,n,r)),Gi(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||o.push(i.query));else{const t=e.views.get(i);t&&(s=s.concat(Qi(t,n,r)),Gi(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||o.push(t.query)))}return a&&!uo(e)&&o.push(new(he(Zi,"Reference.ts has not been loaded"),Zi)(t._repo,t._path)),{removed:o,events:s}}function so(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function ao(e,t){let n=null;for(const r of e.views.values())n=n||Ki(r,t);return n}function co(e,t){if(t._queryParams.loadsAllData())return ho(e);{const n=t._queryIdentifier;return e.views.get(n)}}function lo(e,t){return null!=co(e,t)}function uo(e){return null!=ho(e)}function ho(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo=1;class po{constructor(e){this.listenProvider_=e,this.syncPointTree_=new hi(null),this.pendingWriteTree_={visibleWrites:di.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function _o(e,t,n,r,i){return function(e,t,n,r,i){he(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=fi(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Co(e,new ei({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function go(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Ii(e.pendingWriteTree_,t)){let t=new hi(null);return null!=r.snap?t=t.set(jn(),!0):hn(r.children,(e=>{t=t.set(new Fn(e),!0)})),Co(e,new Xr(r.path,t,n))}return[]}function mo(e,t,n){return Co(e,new ei({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function vo(e,t,n,r,i=!1){const o=t._path,s=e.syncPointTree_.get(o);let a=[];if(s&&("default"===t._queryIdentifier||lo(s,t))){const c=oo(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(o));const l=c.removed;if(a=c.events,!i){const n=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(o,((e,t)=>uo(t)));if(n&&!i){const t=e.syncPointTree_.subtree(o);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&uo(t)){return[ho(t)]}{let e=[];return t&&(e=so(t)),hn(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,o=To(e,r);e.listenProvider_.startListening(Po(i),xo(e,i),o.hashFn,o.onComplete)}}}if(!i&&l.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(Po(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(ko(t));e.listenProvider_.stopListening(Po(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=ko(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function yo(e,t,n,r){const i=So(e,r);if(null!=i){const r=No(i),o=r.path,s=r.queryId,a=Yn(o,t);return Ro(e,o,new ei(Jr(s),a,n))}return[]}function bo(e,t,n,r=!1){const i=t._path;let o=null,s=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=Yn(e,i);o=o||ao(t,n),s=s||uo(t)}));let a,c=e.syncPointTree_.get(i);if(c?(s=s||uo(c),o=o||ao(c,jn())):(c=new to,e.syncPointTree_=e.syncPointTree_.set(i,c)),null!=o)a=!0;else{a=!1,o=xr.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=ao(t,jn());n&&(o=o.updateImmediateChild(e,n))}))}const l=lo(c,t);if(!l&&!t._queryParams.loadsAllData()){const n=ko(t);he(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=fo++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=io(c,t,n,Ei(e.pendingWriteTree_,i),o,a);if(!l&&!s&&!r){const n=co(c,t);u=u.concat(function(e,t,n){const r=t._path,i=xo(e,t),o=To(e,n),s=e.listenProvider_.startListening(Po(t),i,o.hashFn,o.onComplete),a=e.syncPointTree_.subtree(r);if(i)he(!uo(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!Vn(e)&&t&&uo(t))return[ho(t).query];{let e=[];return t&&(e=e.concat(so(t).map((e=>e.query)))),hn(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Po(r),xo(e,r))}}return s}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n))}return u}function wo(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=ao(n,Yn(e,t));if(r)return r}));return Si(r,t,i,n,!0)}function Co(e,t){return Eo(t,e.syncPointTree_,null,Ei(e.pendingWriteTree_,jn()))}function Eo(e,t,n,r){if(Vn(e.path))return Io(e,t,n,r);{const i=t.get(jn());null==n&&null!=i&&(n=ao(i,jn()));let o=[];const s=qn(e.path),a=e.operationForChild(s),c=t.children.get(s);if(c&&a){const e=n?n.getImmediateChild(s):null,t=Li(r,s);o=o.concat(Eo(a,c,e,t))}return i&&(o=o.concat(no(i,e,r,n))),o}}function Io(e,t,n,r){const i=t.get(jn());null==n&&null!=i&&(n=ao(i,jn()));let o=[];return t.children.inorderTraversal(((t,i)=>{const s=n?n.getImmediateChild(t):null,a=Li(r,t),c=e.operationForChild(t);c&&(o=o.concat(Io(c,i,s,a)))})),i&&(o=o.concat(no(i,e,r,n))),o}function To(e,t){const n=t.query,r=xo(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||xr.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=So(e,n);if(r){const n=No(r),i=n.path,o=n.queryId,s=Yn(i,t);return Ro(e,i,new Zr(Jr(o),s))}return[]}(e,n._path,r):function(e,t){return Co(e,new Zr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return vo(e,n,null,r)}}}}function xo(e,t){const n=ko(t);return e.queryToTagMap.get(n)}function ko(e){return e._path.toString()+"$"+e._queryIdentifier}function So(e,t){return e.tagToQueryMap.get(t)}function No(e){const t=e.indexOf("$");return he(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Fn(e.substr(0,t))}}function Ro(e,t,n){const r=e.syncPointTree_.get(t);he(r,"Missing sync point for query tag that we're tracking");return no(r,n,Ei(e.pendingWriteTree_,t),null)}function Po(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(he(eo,"Reference.ts has not been loaded"),eo)(e._repo,e._path):e}class Ao{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Ao(t)}node(){return this.node_}}class Oo{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Hn(this.path_,e);return new Oo(this.syncTree_,t)}node(){return wo(this.syncTree_,this.path_)}}const Do=function(e,t,n){return e&&"object"==typeof e?(he(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Lo(e[".sv"],t,n):"object"==typeof e[".sv"]?Mo(e[".sv"],t):void he(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Lo=function(e,t,n){if("timestamp"===e)return n.timestamp;he(!1,"Unexpected server value: "+e)},Mo=function(e,t,n){e.hasOwnProperty("increment")||he(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&he(!1,"Unexpected increment value: "+r);const i=t.node();if(he(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},Fo=function(e,t,n,r){return qo(t,new Oo(n,e),r)},jo=function(e,t,n){return qo(e,new Ao(t),n)};function qo(e,t,n){const r=e.getPriority().val(),i=Do(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const r=e,o=Do(r.getValue(),t,n);return o!==r.getValue()||i!==r.getPriority().val()?new mr(o,Sr(i)):e}{const r=e;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new mr(i))),r.forEachChild(vr,((e,r)=>{const i=qo(r,t.getImmediateChild(e),n);i!==r&&(o=o.updateImmediateChild(e,i))})),o}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Bo(e,t){let n=t instanceof Fn?t:new Fn(t),r=e,i=qn(n);for(;null!==i;){const e=Oe(r.node.children,i)||{children:{},childCount:0};r=new Uo(i,r,e),n=Bn(n),i=qn(n)}return r}function Wo(e){return e.node.value}function $o(e,t){e.node.value=t,Ko(e)}function zo(e){return e.node.childCount>0}function Ho(e,t){hn(e.node.children,((n,r)=>{t(new Uo(n,e,r))}))}function Vo(e,t,n,r){n&&!r&&t(e),Ho(e,(e=>{Vo(e,t,!0,r)})),n&&r&&t(e)}function Yo(e){return new Fn(null===e.parent?e.name:Yo(e.parent)+"/"+e.name)}function Ko(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Wo(e)&&!zo(e)}(n),i=Ae(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Ko(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Ko(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}const Go=/[\[\].#$\/\u0000-\u001F\u007F]/,Qo=/[\[\].#$\u0000-\u001F\u007F]/,Jo=function(e){return"string"==typeof e&&0!==e.length&&!Go.test(e)},Xo=function(e){return"string"==typeof e&&0!==e.length&&!Qo.test(e)},Zo=function(e,t,n){const r=n instanceof Fn?new Qn(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Xn(r));if("function"==typeof t)throw new Error(e+"contains a function "+Xn(r)+" with contents = "+t.toString());if(on(t))throw new Error(e+"contains "+t.toString()+" "+Xn(r));if("string"==typeof t&&t.length>10485760/3&&We(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Xn(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(hn(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Jo(t)))throw new Error(e+" contains an invalid key ("+t+") "+Xn(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,a;a=t,(s=r).parts_.length>0&&(s.byteLength_+=1),s.parts_.push(a),s.byteLength_+=We(a),Jn(s),Zo(e,o,r),function(e){const t=e.parts_.pop();e.byteLength_-=We(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Xn(r)+" in addition to actual children.")}},es=function(e,t,n,r){if(!(r&&void 0===n||Xo(n)))throw new Error(Ue(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ts=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Jo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Xo(e)}(n))throw new Error(Ue(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ns{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function rs(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null===n||Kn(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function is(e,t,n){rs(e,n),ss(e,(e=>Kn(e,t)))}function os(e,t,n){rs(e,n),ss(e,(e=>Gn(e,t)||Gn(t,e)))}function ss(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(as(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function as(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Qt&&Zt("event: "+n.toString()),_n(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ns,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=zr(),this.transactionQueueTree_=new Uo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ls(e,t,n){if(e.stats_=xn(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Wr(e.repoInfo_,((t,n,r,i)=>{ds(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>fs(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Se(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new er(e.repoInfo_,t,((t,n,r,i)=>{ds(e,t,n,r,i)}),(t=>{fs(e,t)}),(t=>{!function(e,t){hn(t,((t,n)=>{ps(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Tn[n]||(Tn[n]=t()),Tn[n]}(e.repoInfo_,(()=>new Kr(e.stats_,e.server_))),e.infoData_=new $r,e.infoSyncTree_=new po({startListening:(t,n,r,i)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=mo(e.infoSyncTree_,t._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),ps(e,"connected",!1),e.serverSyncTree_=new po({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const o=i(n,r);os(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function us(e){const t=e.infoData_.getNode(new Fn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function hs(e){return(t=(t={timestamp:us(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function ds(e,t,n,r,i){e.dataUpdateCount++;const o=new Fn(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(i)if(r){const t=Le(n,(e=>Sr(e)));s=function(e,t,n,r){const i=So(e,r);if(i){const r=No(i),o=r.path,s=r.queryId,a=Yn(o,t),c=hi.fromObject(n);return Ro(e,o,new ti(Jr(s),a,c))}return[]}(e.serverSyncTree_,o,t,i)}else{const t=Sr(n);s=yo(e.serverSyncTree_,o,t,i)}else if(r){const t=Le(n,(e=>Sr(e)));s=function(e,t,n){const r=hi.fromObject(n);return Co(e,new ti({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,t)}else{const t=Sr(n);s=mo(e.serverSyncTree_,o,t)}let a=o;s.length>0&&(a=ws(e,o)),os(e.eventQueue_,a,s)}function fs(e,t){ps(e,"connected",t),!1===t&&function(e){vs(e,"onDisconnectEvents");const t=hs(e),n=zr();Vr(e.onDisconnect_,jn(),((r,i)=>{const o=Fo(r,i,e.serverSyncTree_,t);Hr(n,r,o)}));let r=[];Vr(n,jn(),((t,n)=>{r=r.concat(mo(e.serverSyncTree_,t,n));const i=xs(e,t);ws(e,i)})),e.onDisconnect_=zr(),os(e.eventQueue_,jn(),r)}(e)}function ps(e,t,n){const r=new Fn("/.info/"+t),i=Sr(n);e.infoData_.updateSnapshot(r,i);const o=mo(e.infoSyncTree_,r,i);os(e.eventQueue_,r,o)}function _s(e){return e.nextWriteId_++}function gs(e,t,n){let r;r=".info"===qn(t._path)?vo(e.infoSyncTree_,t,n):vo(e.serverSyncTree_,t,n),is(e.eventQueue_,t._path,r)}function ms(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}function vs(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Zt(n,...t)}function ys(e,t,n){return wo(e.serverSyncTree_,t,n)||xr.EMPTY_NODE}function bs(e,t=e.transactionQueueTree_){if(t||Ts(e,t),Wo(t)){const n=Es(e,t);he(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=ys(e,t,r);let o=i;const s=i.hash();for(let e=0;e<n.length;e++){const r=n[e];he(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Yn(t,r.path);o=o.updateChild(i,r.currentOutputSnapshotRaw)}const a=o.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{vs(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(go(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Ts(e,Bo(e.transactionQueueTree_,t)),bs(e,e.transactionQueueTree_),os(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)_n(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{rn("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}ws(e,t)}}),s)}(e,Yo(t),n)}else zo(t)&&Ho(t,(t=>{bs(e,t)}))}function ws(e,t){const n=Cs(e,t),r=Yo(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const o=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const c=t[a],l=Yn(n,c.path);let u,h=!1;if(he(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,i=i.concat(go(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,u="maxretry",i=i.concat(go(e.serverSyncTree_,c.currentWriteId,!0));else{const n=ys(e,c.path,o);c.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){Zo("transaction failed: Data returned ",r,c.path);let t=Sr(r);"object"==typeof r&&null!=r&&Ae(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=c.currentWriteId,a=hs(e),l=jo(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=l,c.currentWriteId=_s(e),o.splice(o.indexOf(s),1),i=i.concat(_o(e.serverSyncTree_,c.path,l,c.currentWriteId,c.applyLocally)),i=i.concat(go(e.serverSyncTree_,s,!0))}else h=!0,u="nodata",i=i.concat(go(e.serverSyncTree_,c.currentWriteId,!0))}os(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,s=t[a].unwatcher,setTimeout(s,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(u),!1,null)))))}var s;Ts(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)_n(r[e]);bs(e,e.transactionQueueTree_)}(e,Es(e,n),r),r}function Cs(e,t){let n,r=e.transactionQueueTree_;for(n=qn(t);null!==n&&void 0===Wo(r);)r=Bo(r,n),n=qn(t=Bn(t));return r}function Es(e,t){const n=[];return Is(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function Is(e,t,n){const r=Wo(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Ho(t,(t=>{Is(e,t,n)}))}function Ts(e,t){const n=Wo(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,$o(t,n.length>0?n:void 0)}Ho(t,(t=>{Ts(e,t)}))}function xs(e,t){const n=Yo(Cs(e,t)),r=Bo(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{ks(e,t)})),ks(e,r),Vo(r,(t=>{ks(e,t)})),n}function ks(e,t){const n=Wo(t);if(n){const r=[];let i=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(he(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):(he(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(go(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?$o(t,void 0):n.length=o+1,os(e.eventQueue_,Yo(t),i);for(let e=0;e<r.length;e++)_n(r[e])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=function(e,t){const n=Ns(e),r=n.namespace;"firebase.com"===n.domain&&nn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||nn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&rn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new wn(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Fn(n.pathString)}},Ns=function(e){let t="",n="",r="",i="",o="",s=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):rn(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(s="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const f=t.slice(0,l);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=r}"ns"in d&&(o=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Rs{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Se(this.snapshot.exportVal())}}class Ps{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return he(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Os{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Vn(this._path)?null:Wn(this._path)}get ref(){return new Ds(this._repo,this._path)}get _queryIdentifier(){const e=Br(this._queryParams),t=ln(e);return"{}"===t?"default":t}get _queryObject(){return Br(this._queryParams)}isEqual(e){if(!((e=$e(e))instanceof Os))return!1;const t=this._repo===e._repo,n=Kn(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Ds extends Os{constructor(e,t){super(e,t,new qr,!1)}get parent(){const e=zn(this._path);return null===e?null:new Ds(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ls{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Fn(e),n=Fs(this.ref,e);return new Ls(this._node.getChild(t),n,vr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new Ls(n,Fs(this.ref,t),vr))))}hasChild(e){const t=new Fn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ms(e,t){return(e=$e(e))._checkNotDeleted("ref"),void 0!==t?Fs(e._root,t):e._root}function Fs(e,t){var n,r,i,o;return null===qn((e=$e(e))._path)?(n="child",r="path",o=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),es(n,r,i,o)):es("child","path",t,!1),new Ds(e._repo,Hn(e._path,t))}class js{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Rs("value",this,new Ls(e.snapshotNode,new Ds(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ps(this,e,t):null}matches(e){return e instanceof js&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class qs{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ps(this,e,t):null}createEvent(e,t){he(null!=e.childName,"Child events should have a childName.");const n=Fs(new Ds(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Rs(e.type,this,new Ls(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof qs&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Us(e,t,n,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{gs(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const s=new As(n,o||void 0),a="value"===t?new js(s):new qs(t,s);return function(e,t,n){let r;r=".info"===qn(t._path)?bo(e.infoSyncTree_,t,n):bo(e.serverSyncTree_,t,n),is(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>gs(e._repo,e,a)}function Bs(e,t,n,r){return Us(e,"value",t,n,r)}!function(e){he(!Zi,"__referenceConstructor has already been defined"),Zi=e}(Ds),function(e){he(!eo,"__referenceConstructor has already been defined"),eo=e}(Ds);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ws={};let $s=!1;function zs(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||nn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Zt("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,c=Ss(o,i),l=c.repoInfo;void 0!==qt&&qt.env&&(a=qt.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${l.namespace}`,c=Ss(o,i),l=c.repoInfo):s=!c.repoInfo.secure;const u=i&&s?new yn(yn.OWNER):new vn(e.name,e.options,t);ts("Invalid Firebase Database URL",c),Vn(c.path)||nn("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Ws[t.name];i||(i={},Ws[t.name]=i);let o=i[e.toURLString()];o&&nn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new cs(e,$s,n,r),i[e.toURLString()]=o,o}(l,e,u,new mn(e.name,n));return new Hs(h,e)}class Hs{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ls(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ds(this._repo,jn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Ws[t];n&&n[e.key]===e||nn(`Database ${t}(${e.repoInfo_}) has already been deleted.`),ms(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&nn("Cannot call "+e+" on a deleted database.")}}er.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},er.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){Ut="9.9.4",It(new ze("database",((e,{instanceIdentifier:t})=>zs(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Nt("@firebase/database","0.13.6",e),Nt("@firebase/database","0.13.6","esm2017")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(),r("8vghX").config();!function(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw xt.create("bad-app-name",{appName:String(r)});const i=wt.get(r);if(i){if(Me(e,i.options)&&Me(n,i.config))return i;throw xt.create("duplicate-app",{appName:r})}const o=new Ve(r);for(const e of Ct.values())o.addComponent(e);const s=new kt(e,n,o);wt.set(r,s)}($9d0840e0f81e5cfa$export$fcc0626890c55730);const Vs=function(e=St(),t){return Tt(e,"database").getImmediate({identifier:t})}();var Ys=r("f1q41");const Ks={data:{email:"",fullName:"",userId:"",roomId:"",rtdbRoomId:"",messages:[]},listeners:[],getState(){return this.data},setState(e){this.data=e;for(const e of this.listeners)e();localStorage.setItem("state",JSON.stringify(e)),console.log("nuevo state",this.data)},subscribe(e){this.listeners.push(e)},init(){const e=JSON.parse(localStorage.getItem("state"));this.setState(e),this.accessToRoom((()=>{}),e.roomId)},setEmailAndFullname(e,t,n){const r=this.getState();r.fullName=t,r.email=e,fetch("http://localhost:3099/signup",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:r.email,nombre:r.fullName})}).then((e=>e.json())).then((e=>{r.userId=e.id,this.setState(r),n()})),this.setState(r)},signIn(e){const t=this.getState();t.email?fetch("http://localhost:3099/auth",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:t.email,nombre:t.fullName})}).then((e=>e.json())).then((n=>{t.userId=n.id,this.setState(t),e()})):e(!0)},askNewRoom(e){const t=this.getState();t.userId?fetch("http://localhost:3099/rooms",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({userId:t.userId})}).then((e=>e.json())).then((n=>{t.roomId=n.id,this.setState(t),e()})):console.error("No hay user ID")},accessToRoom(e,t){const n=this.getState();let r;n.roomId?n.roomId&&(r=n.roomId):(r=t,n.roomId=t);const i="http://localhost:3099/rooms/"+r+"?userId="+n.userId;fetch(i).then((e=>e.json())).catch((e=>alert(e))).then((t=>{n.rtdbRoomId=t.rtdbshortRoomId,this.setState(n),this.listenRoom(),e()}))},listenRoom(e){const t=this.getState();Bs(Ms(Vs,"/rooms/"+t.rtdbRoomId),(e=>{const t=this.getState(),n=e.val(),r=Ys.map(n);t.messages=r,this.setState(t)}))},pushMessage(e){const t=this.getState();fetch("http://localhost:3099/messages",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({from:t.fullName,message:e,roomId:t.rtdbRoomId})})}};class Gs extends HTMLElement{connectedCallback(){this.render();const e=this.querySelector(".formulario"),t=this.querySelector("#room-sel"),n=this.querySelector("#room-opt"),r=this.querySelector(".title");t.addEventListener("change",(e=>{"existing"===e.target.value?n.style.display="inherit":(e.target.value,n.style.display="none")})),e.addEventListener("submit",(e=>{e.preventDefault();const t=e.target,n=t.email.value,i=t.nombre.value,o=t.dropdown.value,s=t.roomnum.value;if("none"===o)window.alert("seleccioná Room nuevo o existente");else{function a(e,t){var n=setInterval((()=>{e.innerHTML=`\n            Ingresando al room en ${t}\n            `,--t<0&&(clearInterval(n),setTimeout((()=>{ne.go("/chat")}),800))}),1e3)}Ks.setEmailAndFullname(n,i,(e=>{e&&console.error("hubo un problema en el signup"),Ks.signIn((e=>{e&&console.error("hubo un error en el Auth"),"new"===o?Ks.askNewRoom((()=>{Ks.accessToRoom((e=>{e&&console.error("hubo un error en el accessRoom")}))})):"existing"===o&&Ks.accessToRoom((e=>{e&&console.error("hubo un error en el accessRoom")}),s)}))})),a(r,3)}}))}render(){this.innerHTML='\n    \n    <div class="columns">\n    <div class="column"></div>\n    <div class="column is-two-thirds">\n      <div class="container">\n        <h1 class="title is-1">Bienvenido</h1>\n      </div>\n    </div>\n    <div class="column"></div>\n  </div>\n  \n  <div class="columns">\n    <div class="column"></div>\n      <div class="column is-two-thirds">\n      <form class="formulario">\n        <div class="box">\n          <div class="form">\n            <div class="field">\n              <label class="label">Nombre</label>\n              <div class="control has-icons-left has-icons-right">\n                <input class="input" type="text" placeholder="Tu nombre" name="nombre" required />\n                <span class="icon is-small is-left">\n                  <i class="fas fa-user-astronaut"></i>\n                </span>\n              </div>\n            </div>\n            <div class="field">\n              <label class="label">Email</label>\n              <div class="control has-icons-left has-icons-right">\n                <input class="input" type="email" placeholder="tunombre@ejemplo.com" name="email" required />\n                <span class="icon is-small is-left">\n                  <i class="fas fa-envelope"></i>\n                </span>\n              </div>\n            </div>\n  \n            <div class="field">\n              <label class="label">Room</label>\n              <div class="control">\n                <div class="select">\n                  <select id="room-sel" name="dropdown" required>\n                    <option value="none" selected="true" disabled="disabled">Seleccionar</option>\n                    <option value="new">Nuevo Room</option>\n                    <option value="existing">Room Existente</option>\n                  </select>\n                </div>\n              </div>\n            </div>\n            <div class="field" id="room-opt">\n              <label class="label">ID del Room</label>\n              <div class="control">\n                <input class="input" type="text" placeholder="1111" name="roomnum"/>\n              </div>\n            </div>\n  \n            <div class="field is-grouped">\n              <div class="control">\n                <button class="button is-success">Comenzar</button>\n              </div>\n            </div>\n          </div>\n        </div>\n        </form>\n      </div>\n    <div class="column"></div>\n  </div>\n  \n      ';const e=document.createElement("style");e.innerHTML="\n    :root{\n      background-color: #1C1917\n    }\n    #room-opt{\n      display: none;\n    }\n    .input::placeholder {\n      color: #A8A29E;\n      opacity: 0.75;\n    }\n    * {\n      box-sizing: border-box;\n    }\n    body {\n      margin: 0;\n    }\n    .columns{\n      margin-top: 10px;\n    }\n    .box{\n      background-color: #164E63\n    }\n    .label, .input, #room-sel{\n      color: white\n    }\n    .input, #room-sel{\n      background-color: #155E75\n    }\n    .title{\n      text-align: center;\n      color: #06B6D4\n    }\n    .field{\n      margin-top:1.5em;\n      margin-bottom:1.5em;\n    }\n    @media (max-width: 769px) {\n      .formulario{\n        width: 70%;\n        margin: 0 auto;\n      }\n    }\n    ",this.appendChild(e)}}customElements.define("home-page",Gs);class Qs extends HTMLElement{connectedCallback(){Ks.subscribe((()=>{const e=Ks.getState();this.roomId=e.roomId,void 0!==e.messages&&(this.messages=e.messages,this.render())})),this.render()}addListeners(){this.querySelector(".submit-message").addEventListener("submit",(e=>{e.preventDefault();const t=e.target;Ks.pushMessage(t[0].value)}))}messages=[];render(){const e=Ks.getState();this.innerHTML=`\n  <div class="columns is-mobile">\n    <div class="column"></div>\n    <div class="column is-two-thirds">\n        <div class="container">\n          <h1 class="title is-3">Chat Page</h1>\n          <h4 class="roomid">Room ID es ${e.roomId}</h1>\n          </div>\n          </div>\n          <div class="column"></div>\n          </div>\n          \n          \n          <div class="columns is-mobile">\n          <div class="column"></div>\n          <div class="column is-two-thirds">\n          <div class="content">\n          <div class="subt">Mensajes</div>\n          <div class="containerrr">\n          <div class="messages">\n          ${this.messages.map((t=>{if(void 0!==t.from){if(t.from===e.fullName)return`<div class="msg-container mens-mio">\n                    <div class="messagefrom">${t.from}</div>\n                    <div class="messagecontent">${t.message}</div>\n                    </div>`;if(t.from!==e.fullName)return`<div class="msg-container mens-suyo">\n                    <div class="messagefrom">${t.from}</div>\n                    <div class="messagecontent">${t.message}</div>\n                    </div>`}})).join("")}\n          </div>\n       </div>\n     </div>\n     <form class="submit-message">\n         <input type="text" name="new-message" class="input" placeholder="Tu Mensaje">\n         <button class="button is-success">Enviar</button>\n       </form>\n  </div>\n\n        <div class="column"></div>\n  </div>\n    `;const t=document.createElement("style");t.innerHTML="\n    :root{\n      background-color: #1C1917\n    }\n    * {\n      box-sizing: border-box;\n    }\n    body {\n      margin: 0;\n    }\n    .content{\n      height: 60vh;\n    }\n    .containerrr{\n      height: 50vh;\n      display: flex;\n      flex-direction: column;\n      gap: 20px;\n      overflow: hidden;\n    }\n    .columns{\n      margin-top: 10px;\n    }\n    .content{\n      background-color: #164E63;\n      padding: 20px;\n      border-radius: 0.5em;\n      border: 1px white solid;\n    }\n    .title, .subt, .roomid{\n      text-align: center;\n      color: #06B6D4;\n    }\n    .subt{\n      margin-bottom: 20px;\n    }\n    .input{\n      background-color: #155E75;\n      color: white;\n    }\n    .input::placeholder {\n      color: #A8A29E;\n      opacity: 0.75;\n    }\n    .button{\n      margin-top:20px;\n    }\n    .messages{\n      overflow-y: scroll;\n    }\n    .messages, .msg-container{\n      display: flex;\n      flex-direction: column;\n    }\n    .messagefrom {\n      background-color: rgba(56, 189, 248, 0.7);\n      color: rgb(240, 249, 255);\n      margin: 1.5em 0.5em 0 0.5em;\n      text-align: center;\n      border-radius: 0.5em;\n      padding: 0.7em;\n    }\n    .messagecontent{\n      background-color: transparent;\n      color: white;\n      margin: 0.3em 20px 20px 20px;\n    }\n    .mens-mio{\n      align-self: flex-end;\n    }\n    .mens-suyo{\n      align-self: flex-start;\n    }\n    ",this.appendChild(t),this.addListeners();var n=this.querySelector(".messages");n.scrollTop=n.scrollHeight}}customElements.define("chat-page",Qs);new ne(document.getElementById("app")).setRoutes([{path:"/",component:"home-page"},{path:"/chat",component:"chat-page"}]),function(){document.getElementById("app");console.log(JSON.parse('{"apiKey": "AIzaSyAqmHOSDIcXwLFxGdnxVfnMqwq_3Kq0Ft4","authDomain": "apx-dwf-m6-firebase-db003.firebaseapp.com","databaseURL": "https://apx-dwf-m6-firebase-db003-default-rtdb.firebaseio.com","projectId": "apx-dwf-m6-firebase-db003","storageBucket": "apx-dwf-m6-firebase-db003.appspot.com","messagingSenderId": "77871511541","appId": "1:77871511541:web:62e40d1f09309c5c8a52bc"  "measurementId": "G-ZTJMCGE0KM"}'))}();
//# sourceMappingURL=index.572e0aa9.js.map
